<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="18 Harmonic Analysis | Project XXII" />
<meta property="og:type" content="book" />





<meta name="author" content="Zhengyuan Gao" />

<meta name="date" content="2021-06-24" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="18 Harmonic Analysis | Project XXII">

<title>18 Harmonic Analysis | Project XXII</title>

<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Project XXII<p><p class="author">Zhengyuan Gao</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BA; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preface</a>
<a href="part-i-inference-based-upon-logic-and-logical-computation.html">PART I: Inference Based upon Logic and Logical Computation</a>
<a href="sub-logic.html"><span class="toc-section-number">1</span> Logic</a>
<a href="sub-set-theory.html"><span class="toc-section-number">2</span> Set Theory</a>
<a href="sub-axioms.html"><span class="toc-section-number">3</span> Axioms</a>
<a href="sub-inferknow.html"><span class="toc-section-number">4</span> Inference and Knowledge</a>
<a href="sub-incomplete.html"><span class="toc-section-number">5</span> Incompleteness</a>
<a href="part-ii-infinitesimal-changes-and-their-consequences.html">PART II: Infinitesimal Changes and their Consequences</a>
<a href="sub-continuity.html"><span class="toc-section-number">6</span> Continuity</a>
<a href="sub-calculus.html"><span class="toc-section-number">7</span> Calculus</a>
<a href="ch-DE.html"><span class="toc-section-number">8</span> Differential Equations</a>
<a href="ch-CalUn.html"><span class="toc-section-number">9</span> Calculus under Uncertainty</a>
<a href="part-iii-emergence-of-abstract-interactions.html">PART III: Emergence of Abstract Interactions</a>
<a href="ch-vecMat.html"><span class="toc-section-number">10</span> Vector and Matrix</a>
<a href="ch-MatComp.html"><span class="toc-section-number">11</span> Matrix Computation</a>
<a href="ch-eigen.html"><span class="toc-section-number">12</span> Eigenvalues and Eigenvectors</a>
<a href="ch-UnMulti.html"><span class="toc-section-number">13</span> Uncertainty in Multiple Dimensions</a>
<a href="part-iv-three-masons-to-illuminate-the-dual-world.html">PART IV: Three Masons to Illuminate the Dual World</a>
<a href="ch-representation.html"><span class="toc-section-number">14</span> Representation</a>
<a href="ch-optApp.html"><span class="toc-section-number">15</span> Optimum Approximation</a>
<a href="ch-randomization.html"><span class="toc-section-number">16</span> Randomization</a>
<a href="part-v-complex-ensembles.html">PART V: Complex Ensembles</a>
<a href="ch-complexAn.html"><span class="toc-section-number">17</span> Complex Analysis</a>
<a id="active-page" href="ch-harmonicAn.html"><span class="toc-section-number">18</span> Harmonic Analysis</a><ul class="toc-sections">
<li class="toc"><a href="#sub:heatEq"> Miscellaneous: Harmonic Function, Heat Equation, Exponential Family</a></li>
<li class="toc"><a href="#sub:"> Character and Convolution</a></li>
</ul>
<a href="bibliography.html">Bibliography</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="ch:harmonicAn" class="section level1">
<h1>
<span class="header-section-number">18</span> Harmonic Analysis</h1>
<p>In science, when one experimenting on the particles suspended in the fluid, one has the control to ensure that the trajectories of the particle movements are independent of human factors. In social experiments, the “particles” are, in some sense, ourselves. These “particles” have internal states such as emotion and intelligence. These extra features endow “experimentees” with (perhaps simple) interactional and distributional anti-control capabilities. They can store energy and information, sense their environment, and respond to it. They can change or update their internal states contingently depending on their interactions with each other. In this sense, a simultaneous relationship between the “experimenters” and the “experimentees” naturally can emerge in any social “experiment.”</p>
<p>Let’s think of a social “experiment” as a simultaneous or a structural coupling model.
Unlike the causal model that is a collection of premises from which one can deduce a set of propositions along with the order of the <a href="ch-CalUn.html#sub:conProb">causal chain</a>, a simultaneous model is a collection of synchronic <a href="sub-set-theory.html#sub:order">equivalence relations</a> from which one merely can deduce the <a href="ch-eigen.html#sub:det">invariants</a> under some appropriate transformations.<label for="tufte-sn-565" class="margin-toggle sidenote-number">565</label><input type="checkbox" id="tufte-sn-565" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">565</span> The transformation is often presented by group actions.</span> However, to maintain the <a href="ch-eigen.html#sub:det">invariance</a> under the transformations, the (seemingly disordered) simultaneous model should accompany some <em>ordering parameters</em> that are formed by the “experimentees” and are accepted by the “experimenters” or vice versa. The <strong>ordering parameters</strong> synchronize the microscopic and the macroscopic behaviors of the experiment. They generate the simple principles which the “particles” would like to follow, and they influence the direction in which the paths of the experiment evolve.</p>
<p>The <strong>ordering parameters</strong> may depend only on a few principal components. One typical <strong>ordering parameter</strong> is the <a href="">time arrow</a>, i.e., the time parameter in a <a href="ch-randomization.html#sub:global">one-parameter semigroup</a>. The time attaches the dynamical law to all components in the system. Meanwhile, the interactions of the components follow some invariant operations. The <a href="ch-complexAn.html#sub:ImRelation">spectral representation</a> of the dynamics gives us another vision about the ordering: the order of <a href="ch-eigen.html#sub:det">eigenvalues</a> or <a href="ch-complexAn.html#sub:ImRelation">singular values</a>.<label for="tufte-sn-566" class="margin-toggle sidenote-number">566</label><input type="checkbox" id="tufte-sn-566" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">566</span> For example, when the <a href="ch-complexAn.html#sub:ImRelation">embedding data manifold</a> is a square matrix (circular data manifold), the first eigenvector of the manifold tends to describe the full trend of the series. So projecting the data onto the first eigenvector produces the summation. The following principal order bases, i.e., the 2nd or the 3rd, tend to capture the “low-frequency” components of the data, and the rest basis functions progressively fill in “high-frequency” details.</span></p>
<p>Other important forms of <strong>ordering parameters</strong> are the <a href="ch-optApp.html#sub:appSys">non-negative linear functional</a>, such as the energy, the utility, and (probability) distribution functions.<label for="tufte-sn-567" class="margin-toggle sidenote-number">567</label><input type="checkbox" id="tufte-sn-567" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">567</span> For example, heat is a form of energy produced by the particles’ disordered motion (kinetic energy). Heat can convert to and from different forms of energy. The distribution function from the heat equation relates to the Gaussian probability function, which we will see in ch[?].</span> In practice, man-made indexes, such as wealth or income, tend to play the role of the one-dimensional “ordering” parameter. The simultaneity shaped by this parameter can give rise to specific capitalist social-economic dynamical patterns that bring in inequality and the growth of the society.</p>
<p>All these ordering structures more or less relate to the profound properties of the <a href="ch-complexAn.html#sub:complexCal">complex exponential functions</a> and the <a href="ch-representation.html#sub:conjugacy">abstract Fourier basis</a>. The studies of symmetry (and <a href="ch-complexAn.html#sub:coupling">skew-symmetry</a>), invariants, and group transformations of these functions are in a field called harmonic analysis.<label for="tufte-sn-568" class="margin-toggle sidenote-number">568</label><input type="checkbox" id="tufte-sn-568" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">568</span> The strength of the harmonic analysis is that the <a href="ch-representation.html#sub:conjugacy">abstract Fourier basis</a> produces an ordered and meaningful summarization of the underlying model or data since the <a href="ch-representation.html#sub:conjugacy">Fourier transformation</a> extracts regularities from model or data by projecting them into <a href="ch-randomization.html#sub:SumDecomp">invariant subspaces</a> and orders the basis functions in terms of their smoothness.</span></p>
<div class="solution">
<p class="solution-begin">
Eigen-decomposition of the circular data manifold <span id="sol-start-127" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-127', 'sol-start-127')"></span>
</p>
<div id="sol-body-127" class="solution-body" style="display: none;">
<p>If the <a href="ch-complexAn.html#sub:ImRelation">embedding manifold</a> is a square matrix, the eigenvectors of this embedding manifold relate to <a href="ch-representation.html#sub:dualBasis">Fourier matrices</a>, and the eigenvalues of this manifold relate to the Fourier transform of the embedded time series.</p>
<p>To see this, let’s consider the <a href="ch-MatComp.html#sub:matInv">elementary permutation matrix</a> of a data vector <span class="math inline">\(\mathbf{x}\)</span>:<label for="tufte-sn-569" class="margin-toggle sidenote-number">569</label><input type="checkbox" id="tufte-sn-569" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">569</span> Note that here <span class="math inline">\(\mathbf{L}\)</span> is not a lagged operator but a circular operator.</span><span class="math display">\[\mathbf{L}\mathbf{x}=\left[\begin{array}{cccc}
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]\left[\begin{array}{c}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}
\end{array}\right]=\left[\begin{array}{c}
x_{2}\\
x_{3}\\
x_{4}\\
x_{1}
\end{array}\right].\]</span>
Similarly, one can see that <span class="math inline">\(\mathbf{L}^{2}\mathbf{x}\)</span> gives <span class="math inline">\([x_{3},x_{4},x_{1},x_{2}]^{\top}\)</span>, <span class="math inline">\(\mathbf{L}^{3}\mathbf{x}\)</span> gives <span class="math inline">\([x_{4},x_{1},x_{2},x_{3}]^{\top}\)</span>, while <span class="math inline">\(\mathbf{L}^{4}\mathbf{x}\)</span> return to the original vector <span class="math inline">\(\mathbf{x}\)</span>, namely <span class="math inline">\(\mathbf{L}^{4}=\mathbf{I}\)</span>. We can construct the <em>circular data manifold</em> <span class="math inline">\(\mathbf{M}\)</span> of the vector <span class="math inline">\(\mathbf{x}\)</span>:
<span class="math display">\[\mathbf{M}=x_{1}\mathbf{I}+x_{2}\mathbf{L}+x_{3}\mathbf{L}^{2}+x_{4}\mathbf{L}^{3}=\left[\begin{array}{cccc}
x_{1} &amp; x_{2} &amp; x_{3} &amp; x_{4}\\
x_{4} &amp; x_{1} &amp; x_{2} &amp; x_{3}\\
x_{3} &amp; x_{4} &amp; x_{1} &amp; x_{2}\\
x_{2} &amp; x_{3} &amp; x_{4} &amp; x_{1}
\end{array}\right].\]</span>
The eigenvalues of <span class="math inline">\(\mathbf{L}\)</span> are the roots of the polynomial equation <span class="math inline">\(\lambda^{4}=1\)</span>, because<span class="math display">\[\mathbf{L}\mathbf{x}=\lambda\mathbf{x}=\lambda\left[\begin{array}{c}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}
\end{array}\right]=\left[\begin{array}{c}
x_{2}\\
x_{3}\\
x_{4}\\
x_{1}
\end{array}\right]\]</span>
which leads to <span class="math inline">\(x_{1}=\lambda x_{4}=\lambda^{2}x_{3}=\lambda^{3}x_{2}=\lambda^{4}x_{1}\)</span>, namely <span class="math inline">\(\lambda^{4}=1\)</span>. The eigenvalues are <span class="math inline">\(1\)</span>, <span class="math inline">\(\mbox{i}\)</span>, <span class="math inline">\(\mbox{i}^{2}\)</span>, and <span class="math inline">\(\mbox{i}^{3}\)</span>, the four roots with equal spaces on the unit circle, namely <span class="math inline">\(\mbox{e}^{(2\pi\mbox{i}/4)k}\)</span> with <span class="math inline">\(k=0,1,2,3\)</span>. The corresponding eigenvectors are<span class="math display">\[\mathbf{v}_{1}=\left[\begin{array}{c}
1\\
1\\
1\\
1
\end{array}\right],\,\mathbf{v}_{2}=\left[\begin{array}{c}
1\\
\mbox{i}\\
\mbox{i}^{2}\\
\mbox{i}^{3}
\end{array}\right],\,\mathbf{v}_{3}=\left[\begin{array}{c}
1\\
\mbox{i}^{2}\\
\mbox{i}^{4}\\
\mbox{i}^{6}
\end{array}\right],\,\mathbf{v}_{4}=\left[\begin{array}{c}
1\\
\mbox{i}^{3}\\
\mbox{i}^{6}\\
\mbox{i}^{9}
\end{array}\right],\]</span>
which is equivalent to <span class="math display">\[\mathbf{V}=\left[\begin{array}{cccc}
1 &amp; 1 &amp; 1 &amp; 1\\
1 &amp; \mbox{i} &amp; \mbox{i}^{2} &amp; \mbox{i}^{3}\\
1 &amp; \mbox{i}^{2} &amp; \mbox{i}^{4} &amp; \mbox{i}^{6}\\
1 &amp; \mbox{i}^{3} &amp; \mbox{i}^{6} &amp; \mbox{i}^{9}
\end{array}\right]=\mathbf{F}_{4},\]</span>
a <span class="math inline">\(4\times4\)</span> <a href="ch-representation.html#sub:dualBasis">Fourier matrix</a>.</p>
<p>Let’s generalize this setting to any time series <span class="math inline">\(\mathbf{x}=[x_{1},\dots,x_{T-1}]^{\top}\)</span> and its data embedding manifold
<span class="math display">\[\mathbf{M}=x_{1}\mathbf{I}+x_{2}\mathbf{L}+\cdots+x_{T-1}\mathbf{L}^{T-1}.\]</span>
For the <span class="math inline">\(k\)</span>-th eigenvector <span class="math inline">\(\mathbf{v}_{k}\)</span>, the eigen-decomposition <span class="math inline">\(\mathbf{M}\mathbf{v}_{k}=\lambda_{k}\mathbf{v}_{k}\)</span>
implies that<span class="math display">\[\left(x_{1}\mathbf{I}+x_{2}\mathbf{L}+\cdots+x_{T-1}\mathbf{L}^{T-1}\right)\mathbf{v}_{k}=\left(x_{1}+x_{2}\lambda_{k}+\cdots+x_{T-1}\lambda_{k}^{T-1}\right)\mathbf{v}_{k}.\]</span>
We know for the elemantary permutation matrix <span class="math inline">\(\mathbf{L}\)</span>, the eigenvalue follows <span class="math inline">\(\lambda_{k}=\mbox{e}^{2\pi\mbox{i}(k-1)/T}\)</span>. So the vector of eigenvalues follows <span class="math display">\[\left[\begin{array}{c}
\lambda_{1}\\
\lambda_{2}\\
\vdots\\
\lambda_{T}
\end{array}\right]=\left[\begin{array}{c}
x_{1}+x_{2}+\cdots+x_{T}\\
x_{1}+x_{2}\mbox{e}^{2\pi\mbox{i}/T}+\cdots+x_{T}\mbox{e}^{2\pi\mbox{i}(T-1)/T}\\
\vdots\\
x_{1}+x_{2}\mbox{e}^{2\pi\mbox{i}(T-1)/T}+\cdots+x_{T}\mbox{e}^{2\pi\mbox{i}(T-1)(T-1)}
\end{array}\right]=\mathbf{F}_{T}\left[\begin{array}{c}
x_{1}\\
x_{2}\\
\vdots\\
x_{T}
\end{array}\right].\]</span>
In other words, the eigenvalues of manifold <span class="math inline">\(\mathbf{M}\)</span> are nothing else but the Fourier transform of the embedded time series <span class="math inline">\(\mathbf{x}\)</span>. The first eigenvalue relates to the sum of the series, namely the Fourier transformation of <span class="math inline">\(\mathbf{x}\)</span> under the frequency <span class="math inline">\(2\pi\mbox{i}\times0/T\)</span>; the second eigenvalue relates to the Fourier transformation of <span class="math inline">\(\mathbf{x}\)</span> under the frequency <span class="math inline">\(2\pi\mbox{i}/T\)</span>, and so on. We can see that the lower ranked eigenvalue corresponds to the higher frequency of the transformation.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="sub:heatEq" class="section level2">
<h2>
<span class="header-section-number">18.1</span> Miscellaneous: Harmonic Function, Heat Equation, Exponential Family</h2>
<p>For an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(x,y)+\mbox{i}v(x,y)\)</span>, we have seen how to connect the real and imaginary parts of the function through the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a>.
Now suppose we are only interested in the real parts of the complex function <span class="math inline">\(f(z)\)</span>, namely <span class="math inline">\(u(x,y)\)</span>. YYou may wonder what would be the analytic revelation accompanying this real-valued function <span class="math inline">\(u(x,y)\)</span>.</p>
<p>The revelation comes with an operation of the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a>.
Suppose <span class="math inline">\(f\)</span> satisfies the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a> so that <span class="math inline">\(f\)</span> is analytic and has continuous partial derivatives. Differentiating both sides of one Cauchy-Riemann equation <span class="math inline">\(\frac{\partial u}{\partial x}=\frac{\partial v}{\partial y}\)</span>
with respect to <span class="math inline">\(x\)</span>
and differentiating both sides of the other Cauchy-Riemann equation <span class="math inline">\(\frac{\partial u}{\partial y}=-\frac{\partial v}{\partial x}\)</span> with respect to <span class="math inline">\(y\)</span>, we have
<span class="math display">\[\frac{\partial^{2}u}{\partial x^{2}}=\frac{\partial^{2}v}{\partial x\partial y},\quad\frac{\partial^{2}u}{\partial y^{2}}=-\frac{\partial^{2}v}{\partial y\partial x}.\]</span>
By adding the two equations, we obtain an equation of the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a> of <span class="math inline">\(u(x,y)\)</span>: <span class="math display">\[\frac{\partial^{2}u}{\partial x^{2}}+\frac{\partial^{2}u}{\partial y^{2}}=\Delta u(x,y)=0,\]</span>
where <span class="math inline">\(\Delta\)</span> represents the <a href="ch-MatComp.html#sub:vecSpaces">operator</a> that sums up all the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a> and is called the <em>Laplacian operator</em>. The real-valued function <span class="math inline">\(u(x,y)\)</span> is said to be <em>harmonic</em> if <span class="math inline">\(\Delta u(x,y)=0\)</span>. In other words, for an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(x,y)+\mbox{i}v(x,y)\)</span>, the real part of the <a href="ch-complexAn.html#sub:complexCal">analytic function</a> should be <strong>harmonic</strong>.<label for="tufte-sn-570" class="margin-toggle sidenote-number">570</label><input type="checkbox" id="tufte-sn-570" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">570</span> In a similar manner, we can attain <span class="math display">\[\frac{\partial^{2}u}{\partial y\partial x}=\frac{\partial^{2}v}{\partial y^{2}},\\
\frac{\partial^{2}u}{\partial x\partial u}=-\frac{\partial^{2}v}{\partial x^{2}},\]</span>
namely <span class="math inline">\(\Delta v(x,y)=0\)</span>. So the imaginary part of the analytic function is also a <strong>harmonic function</strong>. The function <span class="math inline">\(v(x,y)\)</span> is called a <em>harmonic conjugate</em> of <span class="math inline">\(u(x,y)\)</span>.
Two <strong>harmonic functions</strong> are said to be <strong>harmonic conjugate</strong> if they satisfy the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a>.</span></p>
<p>Notice that the one-dimensional <strong>Laplacian operator</strong> is nothing else but a second-order differentiation <span class="math inline">\(\Delta f(x)=\mbox{d}^2 f(x)/\mbox{d} x^2\)</span>. We have seen in chapter <a href="ch-representation.html#sub:innerProd">14.2</a> that the <a href="ch-representation.html#sub:innerProd">eigenfunctions</a> of this <strong>Laplacian</strong> <span class="math inline">\(\Delta\)</span> are the trigonometric functions <span class="math inline">\(\sin(\theta x)\)</span> and <span class="math inline">\(\cos(\theta x)\)</span> where <span class="math inline">\((\pm\theta)^2 =\lambda\)</span> are the eigenvalues of <span class="math inline">\(\Delta\)</span>.
Discretizing the <span class="math inline">\(\lambda\)</span> by some integers from <span class="math inline">\(\mathbb{Z}\)</span>, i.e., <span class="math inline">\(\lambda=k^2\)</span> for <span class="math inline">\(k\in\mathbb{Z}\)</span>, we formed the <a href="ch-representation.html#sub:innerProd">Fourier basis</a> functions, i.e., <span class="math inline">\(\phi_k(x) = \mbox{e}^{\mbox{i}kx}\)</span>. Thus, if we have a <strong>harmonic function</strong>, we expect the function to associate with some nice base systems like the <a href="ch-representation.html#sub:innerProd">Fourier bases</a>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:heatDif"></span>
<img src="fig/Part5/heat.gif" alt="Distribution of the heat" width="100%"><!--
<p class="caption marginnote">-->Figure 18.1: Distribution of the heat<!--</p>-->
<!--</div>--></span>
</p>
<p>On the other hand, we can think that a <strong>harmonic function</strong> is (at least locally) a part of an <a href="ch-complexAn.html#sub:complexCal">analytic function</a>.Suppose we have a nice base system induced by the harmonic function on <span class="math inline">\(\mathbb{R}^n\)</span>. In that case, the system can be extended to an analytic complex system in <span class="math inline">\(\mathbb{C}^{n}\)</span> where the <a href="ch-complexAn.html#sub:coupling">complexified system</a> becomes <a href="ch-complexAn.html#sub:complexCal">infinite differentiable</a>, , and some <a href="ch-complexAn.html#sub:complexCal">complex polynomials</a> can represent the derivative operations of the new system.</p>
<p>Using the <strong>harmonic condition</strong> to derive some invariant representations and linking some complex phenomena to simple harmonic bases, these two paths somehow point to the big picture of the harmonic analysis.</p>
<div class="solution">
<p class="solution-begin">
Code for generating heat distributions <span id="sol-start-128" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-128', 'sol-start-128')"></span>
</p>
<div id="sol-body-128" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co"># Discrete spatial location points</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2">x =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb189-3" data-line-number="3">y =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb189-4" data-line-number="4">xy =<span class="st"> </span><span class="kw">expand.grid</span>(x,y)</a>
<a class="sourceLine" id="cb189-5" data-line-number="5"></a>
<a class="sourceLine" id="cb189-6" data-line-number="6"><span class="co">#Initial time</span></a>
<a class="sourceLine" id="cb189-7" data-line-number="7">t0 =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb189-8" data-line-number="8"><span class="co">#Time increment</span></a>
<a class="sourceLine" id="cb189-9" data-line-number="9">dt =<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb189-10" data-line-number="10"><span class="co"># Temperature at t0</span></a>
<a class="sourceLine" id="cb189-11" data-line-number="11">heat =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb189-12" data-line-number="12"><span class="co"># sigma2 squared or c_d</span></a>
<a class="sourceLine" id="cb189-13" data-line-number="13">sigma2=<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb189-14" data-line-number="14"></a>
<a class="sourceLine" id="cb189-15" data-line-number="15"><span class="co"># 2D heat kernel</span></a>
<a class="sourceLine" id="cb189-16" data-line-number="16">heat.kernel =<span class="st"> </span><span class="cf">function</span>(x,y,t){(heat<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">*</span>t<span class="op">/</span>sigma2))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">**</span><span class="dv">2</span><span class="op">+</span>y<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>t<span class="op">*</span>sigma2))}</a>
<a class="sourceLine" id="cb189-17" data-line-number="17">solve.vec =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb189-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb189-19" data-line-number="19">    u =<span class="st"> </span><span class="kw">heat.kernel</span>(xy[<span class="dv">1</span>],xy[<span class="dv">2</span>],t0)</a>
<a class="sourceLine" id="cb189-20" data-line-number="20">    t0 =<span class="st"> </span>t0 <span class="op">+</span><span class="st"> </span>dt</a>
<a class="sourceLine" id="cb189-21" data-line-number="21">    solve.vec=<span class="kw">c</span>(solve.vec,u)</a>
<a class="sourceLine" id="cb189-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb189-23" data-line-number="23"></a>
<a class="sourceLine" id="cb189-24" data-line-number="24"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb189-25" data-line-number="25"><span class="kw">library</span>(plot3D)</a>
<a class="sourceLine" id="cb189-26" data-line-number="26">t =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb189-27" data-line-number="27">solution =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb189-28" data-line-number="28">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb189-29" data-line-number="29"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Time = "</span>, t))</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>One way to understand harmonicity and invariance is to consider the equilibrium state in <a href="ch-DE.html#sub:pde">heat diffusion</a> problems. In chapter <a href="ch-DE.html#sub:pde">8.5</a>, we considered the <a href="ch-DE.html#sub:pde">heat equation</a> in one dimension. Now we extend the problem to two dimensions. The following <em>two-dimensional heat equation</em> describes the dynamics in figure <a href="ch-harmonicAn.html#fig:heatDif">18.1</a>:
<span class="math display">\[\frac{\partial f(x,y,t)}{\partial t}=-c_{D}\left(\frac{\partial^{2}f}{\partial x^{2}}+\frac{\partial^{2}f}{\partial y^{2}}\right)=-c_{D}\Delta f(x,y,t).\]</span>
The <strong>harmonic equation</strong> <span class="math inline">\(\Delta f(x,y,t)=0\)</span> can be thought of as the <a href="ch-DE.html#sub:ode">steady-state</a> or <a href="ch-DE.html#sub:ode">equilibrium solution</a> when there is no heat diffusing in the system, namely <span class="math inline">\(\partial f(x,y,t)/\partial t =0\)</span>. The <strong>Laplacian operator</strong> only counts for the changes regarding the spatial variables <span class="math inline">\((x,y)\)</span>, excluding the time variable <span class="math inline">\(t\)</span>.</p>
<p>To make things more transparent, let’s separate <span class="math inline">\(f\)</span> into two parts, <span class="math inline">\(f(x,y,t)=K(x,y)u(t)\)</span>, where <span class="math inline">\(K(\cdot,\cdot)\)</span> is a function capturing the spatial interaction effect between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and <span class="math inline">\(u(t)\)</span> is the function capturing the dynamical effect. The <strong>2D heat equation</strong> becomes <span class="math display">\[K(x,y)\frac{\mbox{d}u(t)}{\mbox{d}t}=-c_{D}u(t)\Delta K(x,y).\]</span>
Rearrange the expression and assume an unknown constant <span class="math inline">\(c\)</span> for ratios <span class="math display">\[\frac{\mbox{d}u(t)}{\mbox{d}t}\frac{1}{u(t)}=-c_{D}\frac{\Delta K(x,y)}{K(x,y)}=c.\]</span> We arrive in two separate systems. The interaction system forms an eigenvalue problem <span class="math inline">\(\Delta K=\lambda K\)</span> where <span class="math inline">\(\lambda=-c/c_{D}\)</span>, and <span class="math inline">\(K(\cdot,\cdot)\)</span> relates to a kind of the multivariate <a href="ch-representation.html#sub:innerProd">eigenfunction</a> of the <strong>Laplacian operator</strong> <span class="math inline">\(\Delta\)</span>. After solving the eigenvalue <span class="math inline">\(\lambda\)</span>, the value of <span class="math inline">\(c\)</span> becomes available, and so does the solution of the dynamical system <span class="math inline">\(\mbox{d}u(t)/\mbox{d}t=c\)</span>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:ReprodHeat"></span>
<img src="fig/Part5/ReprodHeat.png" alt="Reproduce the 1-rank heat matrix" width="100%"><!--
<p class="caption marginnote">-->Figure 18.2: Reproduce the 1-rank heat matrix<!--</p>-->
<!--</div>--></span>
</p>
<p>The <strong>Laplacian operator</strong> can be rewritten as<label for="tufte-sn-571" class="margin-toggle sidenote-number">571</label><input type="checkbox" id="tufte-sn-571" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">571</span> Because the <a href="ch-vecMat.html#sub:linearity">gradient operators</a> are linear, the inner product of the two <a href="ch-vecMat.html#sub:linearity">gradient operators</a> is still linear. So Laplacian operator is also a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a>.</span>
<span class="math display">\[\begin{align*}\Delta K  &amp;=\frac{\partial^{2}K}{\partial x^{2}}+\frac{\partial^{2}K}{\partial y^{2}}\\
&amp;=\underset{\nabla^{\mbox{H}}}{\underbrace{\left(\frac{\partial}{\partial x}-\mbox{i}\frac{\partial}{\partial y}\right)}}\underset{\nabla K}{\underbrace{\left(\frac{\partial K}{\partial x}+\mbox{i}\frac{\partial K}{\partial y}\right)}}= \nabla^{\mbox{H}}\nabla K.
\end{align*}\]</span>
Let <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\psi\)</span> be the eigenfunctions of the <a href="ch-vecMat.html#sub:linearity">gradient operator</a> <span class="math inline">\(\nabla\)</span> and the <a href="ch-vecMat.html#sub:linearity">adjoint operator</a> <span class="math inline">\(\nabla^{\mbox{H}}\)</span>, respectively. These functions should share the same eigenvalues.<label for="tufte-sn-572" class="margin-toggle sidenote-number">572</label><input type="checkbox" id="tufte-sn-572" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">572</span> Recall that the <a href="ch-UnMulti.html#sub:rw">left-hand eigenvector</a> and the <a href="ch-UnMulti.html#sub:rw">right-hand eigenvector</a>, though probably different, must share the same eigenvalues.</span> So we can decompose <span class="math inline">\(K\)</span> by <span class="math inline">\(\nabla^{\mbox{H}}\nabla K=\lambda K=\lambda\phi\psi\)</span> where <span class="math inline">\(\nabla\phi=\sqrt{\lambda}\phi\)</span> and <span class="math inline">\(\nabla^{\mbox{H}}\psi=\sqrt{\lambda}\psi\)</span>.</p>
<p>The above decomposition tells that two 1D <a href="ch-representation.html#sub:innerProd">orthonormal bases</a> can represent the 2D spatial variation in <span class="math inline">\(K(\cdot,\cdot)\)</span>. We illustrate this decomposition using the data generated by a <strong>2D heat equation</strong>.
Suppose we have two series of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, such that <span class="math inline">\(\mathbf{x},\mathbf{y}\in\mathbb{R}^{N}\)</span>. Now the realizations of <span class="math inline">\(K(\cdot,\cdot)\)</span> are recorded in a matrix
<span class="math display">\[\mathbf{K}=\left[\begin{array}{ccc}
K(x_{1},y_{1}) &amp; \cdots &amp; K(x_{1},y_{N})\\
\vdots &amp; \ddots &amp; \vdots\\
K(x_{N},y_{1}) &amp; \cdots &amp; K(x_{n},y_{N})
\end{array}\right].\]</span>
By the <a href="ch-complexAn.html#sub:ImRelation">singular value decomposition</a>, we can decompose <span class="math inline">\(\mathbf{K}\)</span> as
<span class="math display">\[\mathbf{K} = \mathbf{U}\mathbf{\Sigma}\mathbf{V}^{\top} =\underset{\Phi}{\underbrace{\left(\mathbf{U}\sqrt{\mathbf{\Sigma}}\right)}}\underset{\Psi^{\top}}{\underbrace{(\mathbf{V}\sqrt{\mathbf{\Sigma}})^{\top}}}=\Phi \Psi^{\top}.\]</span>
Note that <span class="math inline">\([\mathbf{K}^{\top}\mathbf{K}]_{ij}=\sum_{k=1}^{N}K(y_{i},x_{k})K(x_{k},y_{j})\)</span> and <span class="math inline">\([\mathbf{K}\mathbf{K}^{\top}]_{ij}=\sum_{k=1}^{N}K(x_{i},y_{k})K(y_{k},x_{j})\)</span>. Thus the matrix <span class="math inline">\(\mathbf{U}\)</span>, as the eigenvector matrix of <span class="math inline">\(\mathbf{K}\mathbf{K}^{\top}\)</span>, is the basis contributed by the input <span class="math inline">\(\mathbf{x}\)</span>, and <span class="math inline">\(\mathbf{V}\)</span>, as the eigenvector matrix <span class="math inline">\(\mathbf{V}\)</span> of <span class="math inline">\(\mathbf{K}^{\top}\mathbf{K}\)</span>, is the basis contributed by the input <span class="math inline">\(\mathbf{y}\)</span>.<label for="tufte-sn-573" class="margin-toggle sidenote-number">573</label><input type="checkbox" id="tufte-sn-573" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">573</span> The matrix <span class="math inline">\(\mathbf{K}\)</span> is extremely singular, i.e. a <a href="ch-MatComp.html#sub:vecSpaces">rank</a>-<span class="math inline">\(1\)</span> matrix <span class="math inline">\(\mbox{rank}(\mathbf{K})=1\)</span>. There is a compact representation for <span class="math inline">\(\mathbf{K}\)</span> such that
<span class="math display">\[\mathbf{K} =\Phi \Psi^{\top} = \sigma_1\phi_1(\mathbf{x}) \psi_1^{\top}(\mathbf{y})\]</span> where <span class="math inline">\(\phi_1(\mathbf{x})\)</span> and <span class="math inline">\(\psi_1(\mathbf{y})\)</span> are the leading eigenvectors in <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Psi\)</span> respectively, and <span class="math inline">\(\sigma_1\)</span> is the leading <a href="ch-complexAn.html#sub:ImRelation">singular value</a>. In this case, the function <span class="math inline">\(K(x,y)\)</span> can be thought of as the “<a href="ch-vecMat.html#sub:matrix">outer-product</a>” of two basis functions <span class="math inline">\(\phi(x)\)</span> and <span class="math inline">\(\psi(y)\)</span> that respectively span the spaces of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. See figure <a href="ch-harmonicAn.html#fig:ReprodHeat">18.2</a>. The “outer product” can be formally defined as a tensor product which we will discuss in ch[?].</span></p>
<div class="solution">
<p class="solution-begin">
Reproduction <span id="sol-start-129" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-129', 'sol-start-129')"></span>
</p>
<div id="sol-body-129" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co"># tensor kernel</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2">t =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb190-3" data-line-number="3">solution =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb190-4" data-line-number="4">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb190-5" data-line-number="5">K =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb190-6" data-line-number="6"></a>
<a class="sourceLine" id="cb190-7" data-line-number="7">phi=<span class="kw">svd</span>(K)<span class="op">$</span>u<span class="op">%*%</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="kw">sqrt</span>(<span class="kw">svd</span>(K)<span class="op">$</span>d[<span class="dv">1</span>]),<span class="kw">rep</span>(<span class="dv">0</span>,(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb190-8" data-line-number="8">psi=<span class="kw">svd</span>(K)<span class="op">$</span>v<span class="op">%*%</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="kw">sqrt</span>(<span class="kw">svd</span>(K)<span class="op">$</span>d[<span class="dv">1</span>]),<span class="kw">rep</span>(<span class="dv">0</span>,(<span class="kw">length</span>(y)<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb190-9" data-line-number="9">phi1=phi[,<span class="dv">1</span>];psi1=psi[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb190-10" data-line-number="10">K.matrix=<span class="kw">outer</span>(phi1,psi1,<span class="st">"*"</span>)</a>
<a class="sourceLine" id="cb190-11" data-line-number="11"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb190-12" data-line-number="12"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey =</span> <span class="kw">list</span>(<span class="dt">side =</span> <span class="dv">1</span>), <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Heat distribution at t = 20"</span>)</a>
<a class="sourceLine" id="cb190-13" data-line-number="13"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>K.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey =</span> <span class="kw">list</span>(<span class="dt">side =</span> <span class="dv">1</span>), <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Reproducing by two eigenvectors "</span>)</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>So far, things go well on two dimensions. But we have to keep in mind that we assume that the <strong>2D heat equation</strong> is separable as <span class="math inline">\(f(x,y,t)=K(x,y)u(t)\)</span>. If we drop this assumption, we should think about parameterizing <span class="math inline">\(K(x,y)\)</span> with the time parameter <span class="math inline">\(t\)</span>, namely a time-varying 2-dimensional “multivariate eigenfunction.”<label for="tufte-sn-574" class="margin-toggle sidenote-number">574</label><input type="checkbox" id="tufte-sn-574" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">574</span> Another way is to consider a 3-dimensional “multivariate eigenfunction,” i.e., <span class="math inline">\(K(x,y,t)\)</span>. The way is analogous to construct a triple “product” of three basis functions. However, according to some spatial-temporal philosophical doctrine, the “product” seems to blend two different basic matters, time and space. Also, the triple “product” is not computationally attractive as it faces the <a href="sub-continuity.html#sub:continuousFunc">curse of dimensionality</a>. Unlike the spatial structure, the long memory encoded in the time <span class="math inline">\(t\)</span> is hardly decomposable. The rank-<span class="math inline">\(1\)</span> example in figure <a href="ch-harmonicAn.html#fig:ReprodHeat">18.2</a> only uses two eigenvectors, namely <span class="math inline">\(2\times 100\)</span>, to reproduce the <span class="math inline">\(100\times 100\)</span> <span class="math inline">\(\mathbf{K}\)</span> matrix. But if we extend the matrix <span class="math inline">\(\mathbf{K}\)</span> to a short time period of <span class="math inline">\(100\)</span> time points, we may probably need to store a large portion of the <span class="math inline">\(200\times 100\)</span> data points rather than three eigenvectors, namely <span class="math inline">\(3\times 100\)</span> data points.</span></p>
<p>Here is some intuition about our planned tour of the parameterization. Let’s assume that <span class="math inline">\(\mathbf{A}\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a> where the following differential problem <span class="math display">\[\frac{\partial K}{\partial t}=\mathbf{A}K,\quad K(x,y,0)=f(x,y,0)\]</span>
admits a solution form <span class="math inline">\(K(x,y,t)=(\mbox{e}^{t\mathbf{A}})f(x,y,0)\)</span>.<label for="tufte-sn-575" class="margin-toggle sidenote-number">575</label><input type="checkbox" id="tufte-sn-575" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">575</span> The solution form <span class="math inline">\((\mbox{e}^{t\mathbf{A}})f(x,y,0)\)</span> can reversely define the meaning of operator <span class="math inline">\(\mathbf{A}\)</span> by the following limit:
<span class="math display">\[\lim_{t\rightarrow0}\frac{e^{\mathbf{A}t}f-f}{t}=\mathbf{A}f.\]</span> In this case, we call <span class="math inline">\(\mathbf{A}\)</span> the <a href="ch-representation.html#sub:pseudoRandom">generator</a> of <span class="math inline">\(K(x,y,t)=(e^{t\mathbf{A}})f(x,y,0)\)</span>.</span> Suppose that we replace the notation <span class="math inline">\(\mathbf{A}\)</span> with the <strong>Laplacian operator</strong> <span class="math inline">\(\Delta\)</span>, and suppose the above statement still holds, then we would obtain a parameterized solution.</p>
<p>The above idea of parameterization is rooting in the applications of abstract exponential objects, such as <span class="math inline">\(\mbox{e}^{t\Delta}\)</span>. To grab the meanings of these abstract exponential objects, we need some knowledge about the <strong>binary operation</strong> and the <strong>group</strong> structure.<label for="tufte-sn-576" class="margin-toggle sidenote-number">576</label><input type="checkbox" id="tufte-sn-576" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">576</span> Recall that the addition and multiplication of real numbers are both <strong>binary operations</strong>. That is, both addition and multiplication combine two real numbers to obtain one real number. In a nutshell, a binary operation is to associating two objects in a given order that will result in one object as the answer.</span></p>
<ul>
<li>
<strong>Binary operation</strong> and <strong>algebraic structure</strong> : A <em>binary operation</em> <span class="math inline">\(\ast\)</span> on a set <span class="math inline">\(\mathcal{V}\)</span>
is a function mapping <span class="math inline">\(\mathcal{V}\times\mathcal{V}\)</span> into <span class="math inline">\(\mathcal{V}\)</span>, namely <span class="math display">\[\ast(\cdot,\cdot):\mathcal{V}\times\mathcal{V}\rightarrow\mathcal{V}.\]</span> For each <span class="math inline">\((f,g)\in\mathcal{V}\times\mathcal{V}\)</span>, the function <span class="math inline">\(\ast(f,g)\)</span> is denoted by <span class="math inline">\(f\ast g\)</span>.
The set <span class="math inline">\(\mathcal{V}\)</span> equipped with the <strong>binary operation</strong> <span class="math inline">\(\ast\)</span> forms an <em>algebraic structure</em> that is denoted by <span class="math inline">\((\mathcal{V},\ast)\)</span>.</li>
</ul>
<p>The definition tells that a <strong>binary operation</strong> gives an <a href="sub-logic.html#sub:ex-computer">algebra</a> on the set <span class="math inline">\(\mathcal{V}\)</span>. Let’s consider <span class="math inline">\(x\ast x\)</span> and let <span class="math inline">\(\ast\)</span> denote any <strong>binary operation</strong>. If <span class="math inline">\(\ast=+\)</span>, for any <span class="math inline">\(a\in\mathbb{R}\)</span>, <span class="math inline">\(x\ast x=x+x=a\)</span> has a solution <span class="math inline">\(x=a/2\in\mathbb{R}\)</span>. However, if <span class="math inline">\(\ast=\times\)</span>, then for some <span class="math inline">\(a\in\mathbb{R}\)</span>, <span class="math inline">\(x\ast x=x\times x=a\)</span> may have no solution, e.g., <span class="math inline">\(a&lt;0\)</span>. In this case, we can see that when the same set of <span class="math inline">\(\mathbb{R}\)</span> is equipped with a different <strong>binary operation</strong>, it displays a very <strong>algebraic structure</strong>. However, sometimes two different sets with very different <strong>binary operations</strong> turn out to have the same <strong>algebraic structure</strong>. For example, the <strong>algebraic structure</strong> <span class="math inline">\((\mathbb{R},+)\)</span> is the same as the algebraic structure <span class="math inline">\((\mathbb{R}^{+}, \times)\)</span> under the exponential function <span class="math inline">\(\mbox{e}^{(\cdot)}:\mathbb{R}\rightarrow\mathbb{R}^{+}\)</span>:
<span class="math display">\[\mbox{e}^{s+t}=\mbox{e}^{s}\times\mbox{e}^{t},\,  \mbox{ for } s,t\in\mathbb{R}.\]</span>
In another way, we can write as <span class="math display">\[\psi(t\ast s)=\mbox{e}^{(t+s)}=\mbox{e}^{t}\times\mbox{e}^{s}=\psi(t)\ast'\psi(s)\]</span>
which says that two <strong>binary algebraic structures</strong>, one for <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> in <span class="math inline">\((\mathcal{V},\ast)\)</span>
and the other for <span class="math inline">\(\mbox{e}^{s}\)</span> and <span class="math inline">\(\mbox{e}^{t}\)</span> in <span class="math inline">\((\mathcal{V}',\ast')\)</span>,
are structurally alike, called <strong>isomorphism</strong>, under the <a href="sub-set-theory.html#sub:func">bijective</a> map <span class="math inline">\(\psi=\mbox{e}^{(\cdot)}\)</span>.<label for="tufte-sn-577" class="margin-toggle sidenote-number">577</label><input type="checkbox" id="tufte-sn-577" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">577</span> Let <span class="math inline">\((\mathcal{V},\ast)\)</span> and <span class="math inline">\((\mathcal{V}',\ast')\)</span> be <strong>binary algebraic structures</strong>. An <em>isomorphism</em> of <span class="math inline">\(\mathcal{V}\)</span> with <span class="math inline">\(\mathcal{V}'\)</span> is a one-to-one function <span class="math inline">\(\psi\)</span> mapping <span class="math inline">\(\mathcal{V}\)</span> onto <span class="math inline">\(\mathcal{V}'\)</span> such that <span class="math inline">\(\phi(f\ast g)=\phi(f)\ast'\phi(g)\)</span> for all <span class="math inline">\(x,y\in\mathcal{V}\)</span>. </span></p>
<ul>
<li>
<em>Group</em> : A <strong>group</strong> is a <strong>binary algebraic structure</strong> <span class="math inline">\((\mathcal{G},\ast)\)</span> such that the following axioms regarding on <span class="math inline">\(\ast\)</span> are satisfied:<label for="tufte-sn-578" class="margin-toggle sidenote-number">578</label><input type="checkbox" id="tufte-sn-578" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">578</span> Notice that <strong>binary algebraic structures</strong> with weaker axioms about one side identity element and one side inverse will lead us to the <a href="ch-randomization.html#sub:global">semigroup</a> structure. The <em>left identity element</em> <span class="math inline">\(\mbox{Id}\)</span> for <span class="math inline">\(\ast\)</span> only holds for <span class="math inline">\(\mbox{Id}\ast x=x\)</span> for all <span class="math inline">\(x\in\mathcal{G}\)</span>. For each <span class="math inline">\(x\in\mathcal{G}\)</span>, if there is an element <span class="math inline">\(y\in\mathcal{G}\)</span> such that <span class="math inline">\(y\ast x=\mbox{Id}\)</span>, then <span class="math inline">\(y\)</span> is the <em>left inverse</em> of <span class="math inline">\(x\)</span>. The right identity and the right inverse can be defined in a similar fashion.</span>
</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Associativity: <span class="math inline">\((f\ast g)\ast h=f\ast(g\ast h)\)</span>
for all <span class="math inline">\(f,g,h\in\mathcal{G}\)</span>.<label for="tufte-sn-579" class="margin-toggle sidenote-number">579</label><input type="checkbox" id="tufte-sn-579" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">579</span> Associativity holds for all elements in the <strong>binary algebraic structures</strong> <span class="math inline">\((\mathbb{F},+)\)</span> and <span class="math inline">\((\mathbb{F},\times)\)</span>.</span></p></li>
<li><p>Existence of an <em>identity element</em> <span class="math inline">\(\mbox{Id}\)</span>: <span class="math inline">\(\mbox{Id} \ast f=f\ast \mbox{Id}=f\)</span> for all <span class="math inline">\(f\in\mathcal{G}\)</span>.<label for="tufte-sn-580" class="margin-toggle sidenote-number">580</label><input type="checkbox" id="tufte-sn-580" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">580</span> Note that the <strong>identity element</strong> <span class="math inline">\(\mbox{Id}\)</span> often appears in different notations under different contexts. For example, <span class="math inline">\(0\)</span> denotes an additive <strong>identity element</strong> in <span class="math inline">\((\mathbb{R},+)\)</span> and <span class="math inline">\(1\)</span> denotes the multiplicative <strong>identity element</strong> in <span class="math inline">\((\mathbb{R},\times)\)</span>. Furthermore, vectors <span class="math inline">\(\mathbf{0}\)</span> and <span class="math inline">\(\mathbf{1}\)</span> are the <strong>identity elements</strong> in <span class="math inline">\((\mathbb{F}^{n},+)\)</span> and <span class="math inline">\((\mathbb{F}^{n},\times)\)</span>, respectively.</span></p></li>
<li><p>Existence of the inverse: For each <span class="math inline">\(f\in\mathcal{G}\)</span>, there is an element <span class="math inline">\(g\in\mathcal{G}\)</span> such that <span class="math inline">\(f\ast g=g\ast f= \mbox{Id}\)</span>. The element <span class="math inline">\(g\)</span> is the inverse of <span class="math inline">\(f\)</span> denoted by <span class="math inline">\(f^{-1}\)</span>.</p></li>
</ol>
<p>We can see that if we let <span class="math inline">\(\mathcal{G}=\{ \mbox{e}^{x}: x\in \mathbb{F} \}\)</span>, then <span class="math inline">\((\mathcal{G}, \times)\)</span> is a <strong>group</strong>.<label for="tufte-sn-581" class="margin-toggle sidenote-number">581</label><input type="checkbox" id="tufte-sn-581" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">581</span> Since <span class="math inline">\(\mathbf{e}^{x}\in \mathbb{F}\)</span>, the associativity holds for the multiplication. The identity element is <span class="math inline">\(1\)</span>. The inverse is <span class="math inline">\(\mbox{e}^{(-x)}\)</span>.</span></p>
<p>All the <span class="math inline">\(m\times n\)</span> matrices come with the <strong>binary operations</strong> addition <span class="math inline">\(+\)</span> and scalar multiplication <span class="math inline">\(\times\)</span>, so they form a <strong>group</strong> called <em>matrix group</em>.</p>
<p>All the <span class="math inline">\(n\times n\)</span> invertible matrices with real number entities together with <strong>additive operations</strong> <span class="math inline">\(+\)</span>, scalar multiplication <span class="math inline">\(\times\)</span>, and the matrix multiplicative <strong>binary operation</strong> <span class="math inline">\(\times\)</span> also form a group called the <em>general linear group of degree <span class="math inline">\(n\)</span></em>, usually denoted by <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span>.<label for="tufte-sn-582" class="margin-toggle sidenote-number">582</label><input type="checkbox" id="tufte-sn-582" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">582</span> Associativity holds for all elements in <span class="math inline">\((\mathbb{F}^{n\times n},+)\)</span> or <span class="math inline">\((\mathbb{F}^{n\times n},\times)\)</span>. The identity element is the identity matrix <span class="math inline">\(\mathbf{I}\)</span> under <span class="math inline">\(+\)</span> or <span class="math inline">\(\times\)</span>. The inverse is <span class="math inline">\(-\mathbf{A}\)</span> under <span class="math inline">\(+\)</span> and <span class="math inline">\(\mathbf{A}^{-1}\)</span> under <span class="math inline">\(\times\)</span> since <span class="math inline">\(\mathbf{A}\)</span> is invertible.</span></p>
<p>Also, all invertible linear operators <span class="math inline">\(\mathbf{T}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> together with the composition <strong>binary operation</strong> <span class="math inline">\(\circ\)</span> forms a <strong>group</strong>, usually denoted by <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span>. It is easy to see that <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span> and <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span> are <strong>isomorphic</strong>, as we have <span class="math inline">\(\mathbf{T}(\mathbf{x})=\mathbf{A}\mathbf{x}\)</span>.</p>
<p>The <em>exponential function of a square matrix</em> <span class="math inline">\(\mathbf{A}\in \mathbb{R}^{n\times n}\)</span> and the <em>exponential function of a linear operator</em> <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span> are defined in a similar manner as the scalar exponential functions:<label for="tufte-sn-583" class="margin-toggle sidenote-number">583</label><input type="checkbox" id="tufte-sn-583" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">583</span> 
However, there is one important difference. The <a href="ch-vecMat.html#sub:vec">commutativity</a> property <span class="math inline">\(\mbox{e}^{z+w}=\mbox{e}^{z}\mbox{e}^{w}\)</span> that holds for <span class="math inline">\(z,w\in\mathbb{R}\)</span> or <span class="math inline">\(z,w\in\mathbb{C}\)</span> is no longer valid. Because matrices or functions are not <a href="ch-vecMat.html#sub:vec">commutative</a> under the matrix multiplication or the functional composition in general, namely <span class="math inline">\(\mathbf{A}\mathbf{B}\neq \mathbf{B}\mathbf{A}\)</span>. According to the definition, <span class="math display">\[\begin{align*}\mbox{e}^{\mathbf{A}\mathbf{B}}&amp;=\mbox{Id}+\mathbf{A}\mathbf{B}+\cdots \\ 
&amp;\neq \mbox{Id}+\mathbf{B}\mathbf{A}+\cdots =\mbox{e}^{\mathbf{B}\mathbf{A}}\end{align*}\]</span> unless <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> are <a href="ch-vecMat.html#sub:vec">commutative</a>.</span>
<span class="math display">\[\mbox{e}^{\mathbf{A}}=\mbox{Id}+\mathbf{A}+\frac{1}{2}\mathbf{A}^{2}+\cdots=\sum_{k=0}^{\infty}\frac{(\mathbf{A})^{k}}{k!}.\]</span></p>
<p>For any <span class="math inline">\(s,t\in\mathbb{F}\)</span>, we can prove that <span class="math inline">\(\mbox{e}^{(s+t)\mathbf{A}}=\mbox{e}^{s\mathbf{A}}\mbox{e}^{t\mathbf{A}}\)</span>.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-130" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-130', 'sol-start-130')"></span>
</p>
<div id="sol-body-130" class="solution-body" style="display: none;">
<p>Note that
<span class="math display">\[\mbox{e}^{(s+t)\mathbf{A}}=\sum_{k=0}^{\infty}\frac{1}{k!}(s+t)^{k}\mathbf{A}^{k}.\]</span>
We have
<span class="math display">\[\begin{align*}
\mbox{e}^{s\mathbf{A}}\mbox{e}^{t\mathbf{A}} &amp;=\left(\sum_{r=0}^{\infty}\frac{s^{r}}{r!}\mathbf{A}^{r}\right)\left(\sum_{k=0}^{\infty}\frac{t{}^{k}}{k!}\mathbf{A}^{k}\right)\\
&amp;=\sum_{r,s=0}^{\infty}\frac{s^{r}t{}^{k}}{r!k!}\mathbf{A}^{r+k}=\sum_{n=0}^{\infty}\left(\sum_{r=0}^{n}\frac{s^{r}t^{n-r}}{r!(n-r)!}\right)\mathbf{A}^{n}\\
&amp;= \sum_{n=0}^{\infty}\frac{1}{n!}\left(\sum_{r=0}^{n}\left(\begin{array}{c}
n\\r
\end{array}\right)s^{r}t^{n-r}\right)\mathbf{A}^{n}\\
&amp;=\sum_{n=0}^{\infty}\frac{(s+t)^{n}}{n!}\mathbf{A}^{n}=\mbox{e}^{(s+t)\mathbf{A}}.
\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>This property ensures that any (square) <strong>matrix exponential function</strong> <span class="math inline">\(\mbox{e}^{\mathbf{A}}\)</span> has its multiplicative inverse <span class="math inline">\(\mbox{e}^{(-\mathbf{A})}\)</span> as
<span class="math display">\[\mathbf{I}=\mbox{e}^{\mathbf{O}}=\mbox{e}^{(1+ (-1))\times \mathbf{A}}=\mbox{e}^{\mathbf{A}}\mbox{e}^{-\mathbf{A}}\]</span> where <span class="math inline">\(\mathbf{O}\)</span> is the <span class="math inline">\(n\times n\)</span> matrix of all zeros. So the set of all (square) matrix exponential functions form a <strong>general linear group of degree <span class="math inline">\(n\)</span></strong>. In other words, the exponential function maps the elements from the <span class="math inline">\(n\times n\)</span> <strong>matrix group</strong> to <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span>.
Similarly, for any <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a> <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span>, the exponential function maps it to the group <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span>.</p>
<p>For our parameterization task, we are especially interested in the <strong>group</strong> of <a href="ch-MatComp.html#sub:vecSpaces">linear operators</a> <span class="math inline">\(\mbox{e}^{t\mathbf{A}}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span> with the parameter <span class="math inline">\(t\in\mathbb{R}\)</span>, called the one-parameter <em>exponential family</em>.</p>
<p>Any member from the one-parameter <strong>exponential family</strong> satisfies <span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}\mbox{e}^{t\mathbf{A}}=\mathbf{A}\mbox{e}^{t\mathbf{A}}\]</span>
because the definition of the exponential function gives<span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}\mbox{e}^{t\mathbf{A}}=\sum_{k=0}^{\infty}\frac{\mbox{d}}{\mbox{d}t}\frac{t^{k}}{k!}\mathbf{A}^{k}=\mathbf{A}\sum_{k=0}^{\infty}\frac{t^{k}}{k!}\mathbf{A}^{k}=\mathbf{A}\mbox{e}^{t\mathbf{A}}.\]</span>
Thus, the one-parameter <strong>exponential family</strong> <span class="math inline">\(\{\mbox{e}^{t\mathbf{A}}\}_{t\in\mathbb{R}}\)</span> associates with the solutions of the following differential equation<label for="tufte-sn-584" class="margin-toggle sidenote-number">584</label><input type="checkbox" id="tufte-sn-584" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">584</span> If we simplify <span class="math inline">\(\mathbf{A}\)</span> as a number <span class="math inline">\(a\in\mathbb{R}\)</span>. We have <span class="math display">\[\begin{align*}\psi_{s+t}(x)&amp;=\mbox{e}^{(s+t)a}f(x,0)=\mbox{e}^{sa}\mbox{e}^{ta}f(x,0)\\
&amp;=(\psi_s\circ\psi_t)(x).\end{align*}\]</span> The <strong>group</strong> <span class="math inline">\((\mathbb{R}^{+},\times)\)</span> of elements <span class="math inline">\(\{\mbox{e}^{t}\}_{t\in\mathbb{R}}\)</span> acts on <span class="math inline">\(f(x,0)\)</span>. So the solution is a <strong>group</strong> acting of the <span class="math inline">\(f(x,0)\)</span> called <em>group action</em>. Here the parameter <span class="math inline">\(t\)</span> is from the <strong>group</strong> <span class="math inline">\((\mathbb{R},+)\)</span>, and it is <strong>isomorphic</strong> to <span class="math inline">\((\mathbb{R}^{+},\times)\)</span>. So we can also say the parameter <strong>group</strong> <span class="math inline">\((\mathbb{R}^{+},\times)\)</span> acting on <span class="math inline">\(f(x,0)\)</span> results the solution of <span class="math inline">\(f(x,t)\)</span>.</span> <span class="math display">\[\frac{\mbox{d}\mathbf{f}(t)}{\mbox{d}t}=\mathbf{A}\mathbf{f}(t)\]</span>
where <span class="math inline">\(\mathbf{f}(t):\mathbb{R}\rightarrow\mathbb{R}^{n}\)</span> is some function evaluated at <span class="math inline">\(n\)</span> points at time <span class="math inline">\(t\)</span>.<label for="tufte-sn-585" class="margin-toggle sidenote-number">585</label><input type="checkbox" id="tufte-sn-585" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">585</span> For example, the heat function <span class="math inline">\(f(x,y,t)\)</span> evaluated at <span class="math inline">\(30\)</span> spatial points of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> gives <span class="math inline">\(n=900\)</span> points at time <span class="math inline">\(t\)</span>. The operator <span class="math inline">\(\mathbf{A}\)</span> can be thought of as a <span class="math inline">\(900\times 900\)</span> <a href="ch-MatComp.html#sub:LU">second-order difference matrix</a> defined in chapter <a href="ch-MatComp.html#sub:LU">11.3</a>. (However, one needs to sort the points in a particular way to make the matrix work properly. But this sorting is not our concern now.)</span></p>
<p>In particular, we know that the differentiation operator <span class="math inline">\(\frac{\mbox{d}}{\mbox{d}t}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a>. For any <span class="math inline">\(s\in\mathbb{R}\)</span>, we can prove that the <strong>exponential linear operator function</strong> is <span class="math display">\[\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}=\mathbf{L}^{-s},\]</span>
where <span class="math inline">\(\mathbf{L}^{-s}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> is the operator translating forwardly of the object by <span class="math inline">\(s\)</span> units such that <span class="math inline">\((\mathbf{L}^{-s}\mathbf{f})(0)=\mathbf{f}(s)\)</span>. This <strong>exponential linear operator function</strong> provides the generic (numerical) solution of the differential equations.<label for="tufte-sn-586" class="margin-toggle sidenote-number">586</label><input type="checkbox" id="tufte-sn-586" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">586</span> For the heat equation problem, we have <span class="math inline">\(\mbox{d}/\mbox{dt}(\cdot)=\Delta(\cdot)\)</span>. So the solution is <span class="math display">\[\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}\mathbf{f}(0)=\mbox{e}^{s\Delta}\mathbf{f}(0)=\mathbf{f}(s).\]</span> Basically, the solution tells us at any time <span class="math inline">\(t\)</span> an <strong>exponential family</strong> <span class="math inline">\(\mbox{e}^{t\Delta}\)</span> acting on vectorized initial data <span class="math inline">\(\mathbf{f}(0)\)</span>, and the action describes how the heat diffuses at time <span class="math inline">\(t\)</span>.</span></p>
<div class="solution">
<p class="solution-begin">
Sketch of the proof <span id="sol-start-131" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-131', 'sol-start-131')"></span>
</p>
<div id="sol-body-131" class="solution-body" style="display: none;">
<p>Here I only consider <span class="math inline">\(\mathbf{f}(t)\)</span> as the vector representation of a polynomial function <span class="math inline">\(f(t)\)</span> of degree <span class="math inline">\(n-1\)</span>.<label for="tufte-sn-587" class="margin-toggle sidenote-number">587</label><input type="checkbox" id="tufte-sn-587" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">587</span> In principle, one can choose <span class="math inline">\(n\)</span> to be arbitrary large so that the polynomial function can approximate well to any potential solution.</span> The space of polynomial functions of degree <span class="math inline">\(n-1\)</span> has <span class="math inline">\(n\)</span> basis <span class="math inline">\(\{1,t,t^{2},\dots,t^{n-1}\}\)</span>, and it is <strong>isomorphic</strong> to <span class="math inline">\(\mathbb{R}^{n}\)</span> such that<span class="math display">\[f(t)=c_{1}+c_{2}t+\cdots+c_{n}t^{n-1}\Leftrightarrow\mathbf{f}(t)=\left[\begin{array}{c}
c_{1}\\
c_{2}t\\
\vdots\\
c_{n}t^{n-1}
\end{array}\right].\]</span>
Let an operator <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span>
be <span class="math inline">\(\mathbf{A}\mathbf{f}=\frac{\mbox{d}\mathbf{f}}{\mbox{d}t}\)</span>.</p>
<p>The Taylor series for any polynomial <span class="math inline">\(f(t+s)\)</span> at <span class="math inline">\(t\)</span> has the following form
<span class="math display">\[f(t+s)=f(t)+\frac{s}{1}\frac{\mbox{d}p(t)}{\mbox{d}t}+\frac{s^{2}}{2}\frac{\mbox{d}^{2}f(t)}{\mbox{d}t^{2}}+\cdots.\]</span>
The above expression can be written in the vector form as follows
<span class="math display">\[\left(\mbox{Id}\times\mathbf{f}+s\mathbf{A}\mathbf{f}+\frac{s^{2}}{2}\mathbf{A}^{2}\mathbf{f}+\cdots\right)=\sum_{k=0}^{\infty}\frac{(s\mathbf{A})^{k}}{k!}\mathbf{f}=\mbox{e}^{s\mathbf{A}}\mathbf{f}.\]</span></p>
<p>In other words, we have<span class="math display">\[\mbox{e}^{s\mathbf{A}}\mathbf{f}=\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}\mathbf{f}=\mathbf{L}^{-s}\mathbf{f}.\]</span>
for any polynomial vector <span class="math inline">\(\mathbf{f}(\cdot)\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="sub:" class="section level2">
<h2>
<span class="header-section-number">18.2</span> Character and Convolution</h2>
<p>The word “harmonic” often describes a quality of sound. The name of the <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> reveals a roundabout connection between the source of sound created by the periodic vibrating strings and the “harmonic motion” generated by the Fourier series. Our current attempt is to concretize this roundabout route so that we can connect various distant concepts in a unified roadmap.<label for="tufte-sn-588" class="margin-toggle sidenote-number">588</label><input type="checkbox" id="tufte-sn-588" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">588</span> The title of this section is the “hub station” of the tour.</span></p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:WaveEq"></span>
<img src="fig/Part5/WaveEq.gif" alt="Wave equation" width="100%"><!--
<p class="caption marginnote">-->Figure 18.3: Wave equation<!--</p>-->
<!--</div>--></span>
</p>
<p><span class="newthought">From Wave to Fourier series and periodicity</span></p>
<p>For the <a href="ch-DE.html#sub:pde">1D heat equation</a> problem, it is natural to imagine that at the end of the heat diffusion process, everywhere of the domain reaches the same temperature because <span class="math inline">\(\Delta f(x)= \mbox{d}^2f(x)/\mbox{d}x^2=0\)</span> can only induce that <span class="math inline">\(f(x)\)</span> is a constant on the domain. In this case, we anticipate the system to arrive at its equilibrium state. The temperature of all states become still in this kind of egalitarianism’s equilibrium. Moreover, the role of time vanishes as <span class="math inline">\(\mbox{d}f/\mbox{d}t=0\)</span>.</p>
<p>However, we have confronted another type of equilibrium, the periodic equilibrium; the variations recur in a cyclic pattern (see chapter <a href="ch-UnMulti.html#sub:rw">13.3</a>). The role of time in this kind of equilibrium persistently unfolds the repeating episodes, so it is never dismissed. The periodic equilibrium can happen for the <a href="ch-harmonicAn.html#sub:heatEq">2D heat equation</a> problem. When <span class="math inline">\(\mbox{d}f/\mbox{d}t=0\)</span>, the equation <span class="math inline">\(\Delta f(x,y,t)=0\)</span> rather than degenerates to a constant function, has a <a href="ch-representation.html#sub:innerProd">Fourier series representation</a> of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Here, the basis functions of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> perform as vibrating periodic strings such that the gain/loss caused by the second derivatives of <span class="math inline">\(x\)</span> compensate the opposite effect of <span class="math inline">\(y\)</span>.<label for="tufte-sn-589" class="margin-toggle sidenote-number">589</label><input type="checkbox" id="tufte-sn-589" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">589</span> The equation <span class="math inline">\(\Delta f(x,y)=0\)</span> is called the <em>Laplace’s equation</em>. Assume that <span class="math inline">\(f(x,y)=\phi(x)\psi(y)\)</span>. The equation becomes <span class="math display">\[0=\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}\psi(y) +\phi(x)\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}\]</span> or say <span class="math display">\[\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}=-\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}=A_n,\]</span> For each constant <span class="math inline">\(A_n\)</span>, we have a system of two equations <span class="math display">\[\begin{align*}\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}   &amp;=A_n\phi(x),\\
\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}   &amp;=-A_n\psi(y).\end{align*}\]</span>
The system coincides with the coupling structure in equation <a href="ch-complexAn.html#eq:coupling">(17.1)</a>. The <a href="ch-representation.html#sub:innerProd">Fourier series</a>, as this coupling system’s <a href="ch-representation.html#sub:innerProd">eigenfunctions</a>, offers the vibrating periodic solution.</span></p>
<p>One of the well-known vibrating periodic systems is the <em>wave equation</em> <span class="math display">\[\frac{\mbox{d}^{2}f(x,y,t)}{\mbox{d}t^{2}}=\Delta f(x,y,t).\]</span> In this system, the vibration energy created by the <a href="ch-harmonicAn.html#sub:heatEq">Laplacian</a> is completely transmitted along the arrow of time (through the second-order derivatives of time). The <a href="ch-representation.html#sub:innerProd">Fourier series</a> also solve the <strong>wave equation</strong>. The visual solution is given in figure <a href="ch-harmonicAn.html#fig:WaveEq">18.3</a>.<label for="tufte-sn-590" class="margin-toggle sidenote-number">590</label><input type="checkbox" id="tufte-sn-590" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">590</span> The Fourier basis <span class="math inline">\(\mbox{e}^{\mbox{i}n\theta}\)</span> forms the wave terms <span class="math inline">\(\cos(n\theta)\)</span> and <span class="math inline">\(\sin(n\theta)\)</span>. The integer <span class="math inline">\(n=1,2,3,\dots\)</span> means that possible wavelengths are <span class="math inline">\(\frac{1}{2\pi},\frac{1}{4\pi},\dots\)</span>. With the Fourier series, we can write every continuous periodic function as a sum of simple waves. A similar result holds for non-periodic functions on <span class="math inline">\(\mathbb{R}\)</span>, provided that they have finite <span class="math inline">\(L^2\)</span>-norms. Also, for non-periodic function, there is no restriction on the wavelengths, so every positive real number can occur.</span></p>
<div class="solution">
<p class="solution-begin">
Wave equation: solution and code <span id="sol-start-132" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-132', 'sol-start-132')"></span>
</p>
<div id="sol-body-132" class="solution-body" style="display: none;">
<p>Consdier the <strong>wave equation</strong> <span class="math display">\[\frac{\mbox{d}^{2}f(x,y,t)}{\mbox{d}t^{2}}=\Delta f(x,y,t).\]</span>
For an explicit solution, let’s assume <span class="math inline">\(f(x,y,t)=\phi(x)\psi(y)\gamma(t)\)</span>. The <strong>wave equation</strong> becomes <span class="math display">\[\phi(x)\psi(y)\frac{\mbox{d}^{2}\gamma(t)}{\mbox{d}t^{2}}=\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}\psi(y)\gamma(t)+\phi(x)\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}\gamma(t)\]</span>
which is equivalent to<span class="math display">\[\frac{\mbox{d}^{2}\gamma(t)/\mbox{d}t^{2}}{\gamma(t)}=\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}+\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}=A.\]</span>
Now we have a system of three equations. One is<span class="math display">\[\frac{\mbox{d}^{2}\gamma(t)/\mbox{d}t^{2}}{\gamma(t)}=A\mbox{ or}\frac{\mbox{d}^{2}\gamma(t)}{\mbox{d}t^{2}}=A\gamma,\]</span>
and the other two are from <span class="math display">\[\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}=B=-\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}+A,\]</span>
namely <span class="math display">\[\begin{align*}\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}    &amp;=B\phi(x),\\
\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}   &amp;=(A-B)\psi(y)=C\psi(y).\end{align*}\]</span>
All these three are eigenfunctions-eigenvalues problems where eigenvalues are <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, and the eigenfunctions are Fourier series.</p>
<p>For <span class="math inline">\(\phi(x)\)</span> and <span class="math inline">\(\psi(y)\)</span>, we can use sine seires to represent them <span class="math display">\[\phi(x)=\sum_{m}\sin\frac{m\pi}{a}x,\;\psi(y)=\sum_{n}\sin\frac{n\pi}{b}y\]</span>
where <span class="math inline">\(B=-(m/a)^{2}\)</span> and <span class="math inline">\(C=-(n/b)^{2}\)</span>. As <span class="math inline">\(A=B+C=-(m/a)^{2}+(n/b)^{2}&lt;0\)</span>, we represent <span class="math inline">\(\gamma(t)\)</span> by <span class="math display">\[\gamma_{mn}(t)=\cos\omega_{mn}t+\sin\omega_{mn}t\]</span>
where <span class="math inline">\(\omega_{mn}=\pi\sqrt{(m/a)^{2}+(n/b)^{2}}\)</span>. The general solution is <span class="math display">\[u(x,y,t)=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right)\left(\cos\omega_{mn}t+\sin\omega_{mn}t\right).\]</span>
Note that for each pair <span class="math inline">\((m,n)\)</span>, <span class="math display">\[\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right)\left(\cos\omega_{mn}t+\sin\omega_{mn}t\right)\]</span>
is also a solution of the wave equation.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="co"># wave</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2">x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb191-3" data-line-number="3">y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb191-4" data-line-number="4">xy =<span class="st"> </span><span class="kw">expand.grid</span>(x,y)</a>
<a class="sourceLine" id="cb191-5" data-line-number="5"></a>
<a class="sourceLine" id="cb191-6" data-line-number="6"><span class="co">#Wave speed</span></a>
<a class="sourceLine" id="cb191-7" data-line-number="7">c =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="co">#Initial time</span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9">t0 =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb191-10" data-line-number="10"><span class="co">#Time increment</span></a>
<a class="sourceLine" id="cb191-11" data-line-number="11">dt =<span class="st"> </span><span class="fl">0.03</span></a>
<a class="sourceLine" id="cb191-12" data-line-number="12"><span class="co">#Try every combination</span></a>
<a class="sourceLine" id="cb191-13" data-line-number="13">n =<span class="st"> </span><span class="dv">2</span> <span class="co">#1 #5 #2 #5</span></a>
<a class="sourceLine" id="cb191-14" data-line-number="14">m =<span class="st"> </span><span class="dv">3</span> <span class="co">#1 #5 #3 #3</span></a>
<a class="sourceLine" id="cb191-15" data-line-number="15"></a>
<a class="sourceLine" id="cb191-16" data-line-number="16">w =<span class="st"> </span>pi<span class="op">*</span>c<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">**</span><span class="dv">2</span><span class="op">+</span>m<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb191-17" data-line-number="17">Fourier.sol =<span class="st"> </span><span class="cf">function</span>(x,y,t){(<span class="kw">cos</span>(w<span class="op">*</span>t)<span class="op">+</span><span class="kw">sin</span>(w<span class="op">*</span>t))<span class="op">*</span><span class="kw">sin</span>(pi<span class="op">*</span>m<span class="op">*</span>x)<span class="op">*</span><span class="kw">sin</span>(n<span class="op">*</span>pi<span class="op">*</span>y)}</a>
<a class="sourceLine" id="cb191-18" data-line-number="18"></a>
<a class="sourceLine" id="cb191-19" data-line-number="19">solve.vec =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb191-20" data-line-number="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){</a>
<a class="sourceLine" id="cb191-21" data-line-number="21">    f =<span class="st"> </span><span class="kw">Fourier.sol</span>(xy[<span class="dv">1</span>],xy[<span class="dv">2</span>],t0)</a>
<a class="sourceLine" id="cb191-22" data-line-number="22">    t0 =<span class="st"> </span>t0 <span class="op">+</span><span class="st"> </span>dt</a>
<a class="sourceLine" id="cb191-23" data-line-number="23">    solve.vec=<span class="kw">c</span>(solve.vec,f)</a>
<a class="sourceLine" id="cb191-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb191-25" data-line-number="25"></a>
<a class="sourceLine" id="cb191-26" data-line-number="26"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb191-27" data-line-number="27"><span class="kw">library</span>(plot3D)</a>
<a class="sourceLine" id="cb191-28" data-line-number="28">t =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb191-29" data-line-number="29">solution.wave =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb191-30" data-line-number="30">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution.wave, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb191-31" data-line-number="31"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">colkey=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Time = "</span>, t))</a></code></pre></div>
<p>In particular, if the wave problem has boundary condition, such as <span class="math inline">\(u(x,y,0)=f(x,y)\)</span>
and <span class="math inline">\(\frac{\mbox{d}u(x,y,0)}{\mbox{d}t}=g(x,y)\)</span>. One can use double Fourier series to represent <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> such that <span class="math display">\[\begin{align*}f(x,y)=&amp;  u(x,y,0)=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}c_{mn}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right),\\
g(x,y)=&amp;    \frac{\mbox{d}u(x,y,0)}{\mbox{d}t}=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}\tilde{c}_{mn}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right).\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From periodicity to cyclic groups</span></p>
<p>Recall that a function <span class="math inline">\(f\)</span> on <span class="math inline">\(\mathbb{R}\)</span> is <a href="ch-UnMulti.html#sub:rw">periodic</a> with a period <span class="math inline">\(T\)</span> if <span class="math inline">\(f(x+T)=f(x)\)</span>.<label for="tufte-sn-591" class="margin-toggle sidenote-number">591</label><input type="checkbox" id="tufte-sn-591" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">591</span> The formal notation of the space of all continuous periodic functions on <span class="math inline">\(\mathbb{R}\)</span> is <span class="math inline">\(\mathcal{C}(\mathbb{R}/\mathbb{Z})\)</span>, where <span class="math inline">\(\mathbb{R}/\mathbb{Z}\)</span> (often called a <em>quotient space</em>) is to split <span class="math inline">\(\mathbb{R}\)</span> into <a href="sub-set-theory.html#sub:order">equivalence classes</a> of all integers. Note that for each <span class="math inline">\(x\in\mathbb{R}\)</span>, its <a href="sub-set-theory.html#sub:order">equivalence class</a> of all integers is <span class="math display">\[\{x+k|k\in\mathbb{Z}\}.\]</span>
Thus, the set of all equivalence classes of <span class="math inline">\(\mathbb{Z}\)</span> forms a partition of <span class="math inline">\(\mathbb{R}\)</span>: <span class="math display">\[\mathbb{R}/\mathbb{Z}=\left\{ \left.x+k\right|k\in\mathbb{Z},x\in\mathbb{R}\right\}.\]</span></span></p>
<p>The cyclic nature of the variable <span class="math inline">\(T\)</span> in <span class="math inline">\(f(x)=f(x+T)\)</span> means that we have invariance with respect to translation in a period of <span class="math inline">\(T\)</span>. In another sense, this is an invariance with respect to the <a href="ch-harmonicAn.html#sub:heatEq">group</a> of translations in the frequency of <span class="math inline">\(T\)</span>.<label for="tufte-sn-592" class="margin-toggle sidenote-number">592</label><input type="checkbox" id="tufte-sn-592" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">592</span> One can verify a periodic set is a <a href="ch-harmonicAn.html#sub:heatEq">group</a> when one considers <span class="math inline">\(f(x+T)=\mathbf{L}^{-T}f(x)\)</span> under the <a href="ch-randomization.html#sub:SumDecomp">shift operator</a> <span class="math inline">\(\mathbf{L}^{-T}\)</span>. In this case, one can compose two periodic translations <span class="math inline">\(\mathbf{L}^{-sT}\mathbf{L}^{-kT}\)</span> and obtain another periodic translation <span class="math inline">\(\mathbf{L}^{-(s+k)T}\)</span>, and one can have the inverse of a periodic translation by translating in the negative direction of the original one such as <span class="math inline">\(\mathbf{L}^{T}f(x)=f(x-T)=f(x)\)</span>.</span></p>
<ul>
<li>
<strong>Subgroup</strong> : Consider the <a href="ch-harmonicAn.html#sub:heatEq">group</a> structure <span class="math inline">\((\mathcal{G},\ast)\)</span>. If a subset <span class="math inline">\(\mathcal{G}_{s}\)</span> of <span class="math inline">\(\mathcal{G}\)</span> is <a href="ch-randomization.html#sub:SumDecomp">closed</a> under the <a href="ch-harmonicAn.html#sub:heatEq">binary operation</a> <span class="math inline">\(\ast\)</span>, then <span class="math inline">\((\mathcal{G}_{s},\ast)\)</span> is a <em>subgroup</em> of <span class="math inline">\((\mathcal{G},\ast)\)</span>.<label for="tufte-sn-593" class="margin-toggle sidenote-number">593</label><input type="checkbox" id="tufte-sn-593" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">593</span> The binary operation of the <strong>subgroup</strong> should be the same as that of the original <a href="ch-harmonicAn.html#sub:heatEq">group</a>. Note that <span class="math inline">\((\mathbb{Q}^{+},\times)\)</span> is not a <strong>subgroup</strong> of <span class="math inline">\((\mathbb{R},+)\)</span> even though <span class="math inline">\(\mathbb{Q}^{+}\subset\mathbb{R}\)</span>.</span>
</li>
</ul>
<p>It is easy to see that if a <strong>subgroup</strong> <span class="math inline">\((\mathcal{G}_{s},\ast)\)</span> of <span class="math inline">\((\mathcal{G},\ast)\)</span> contains <span class="math inline">\(f\in\mathcal{G}\)</span>, then it must also contain <span class="math inline">\(f\ast f\)</span>, <span class="math inline">\(f\ast f\ast f, \dots\)</span>, etc., namely <span class="math display">\[\underset{n-\mbox{times}}{\underbrace{f\ast\cdots\ast f}=f^{(\ast n)}} \in (\mathcal{G}_s,\ast) \:\mbox{ for any }n\in\mathbb{Z}.\]</span></p>
<ul>
<li>
<strong>Cyclic (sub)group</strong> : Let <span class="math inline">\((\mathcal{G},\ast)\)</span> be a <a href="ch-harmonicAn.html#sub:heatEq">group</a>. For any <span class="math inline">\(f\in\mathcal{G}\)</span>, the set
<span class="math inline">\(\mathcal{G}_{c}=\left\{ \left.f^{(\ast n)}\right|n\in\mathbb{Z}\right\}\)</span>
forms a <strong>subgroup</strong> <span class="math inline">\((\mathcal{G}_c,\ast)\)</span> of
<span class="math inline">\((\mathcal{G},\ast)\)</span>.<label for="tufte-sn-594" class="margin-toggle sidenote-number">594</label><input type="checkbox" id="tufte-sn-594" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">594</span> The associative law gives <span class="math inline">\(f^{(\ast t)}f^{(\ast s)}=f^{(\ast(t+s))}\)</span> for any <span class="math inline">\(t,s\in\mathbb{Z}\)</span>. The identity element is <span class="math inline">\(f^{(\ast t)}f^{(\ast(-t))}=f^{(\ast0)}=\mbox{Id}\)</span>. Hence we can ensure that <span class="math inline">\((\mathcal{G}_{c},\ast)\)</span> is a <strong>subgroup</strong> of <span class="math inline">\((\mathcal{G},\ast)\)</span>.</span> We say <span class="math inline">\((\mathcal{G}_c,\ast)\)</span> is <a href="ch-representation.html#sub:pseudoRandom">generated</a> by <span class="math inline">\(f\)</span>. the <a href="ch-harmonicAn.html#sub:heatEq">group</a> <span class="math inline">\((\mathcal{G}_{c}, \ast)\)</span> is the smallest <strong>subgroup</strong> of <span class="math inline">\((\mathcal{G},\ast)\)</span> that contains <span class="math inline">\(f\)</span>. That is, every <strong>subgroup</strong> containing <span class="math inline">\(f\)</span> must contain <span class="math inline">\(\mathcal{G}_{c}\)</span>. The subgroup <span class="math inline">\((\mathcal{G}_{c}, \ast)\)</span> is called the <em>cyclic subgroup</em> of <span class="math inline">\((\mathcal{G},\ast)\)</span> <a href="ch-representation.html#sub:pseudoRandom">generated</a> by <span class="math inline">\(f\)</span>. On the other hand, when an element <span class="math inline">\(f\)</span> <a href="ch-representation.html#sub:pseudoRandom">generates</a> a <a href="ch-harmonicAn.html#sub:heatEq">group</a> <span class="math inline">\((\mathcal{F},\ast)\)</span>, <span class="math inline">\(f\)</span> is called the <em>generator</em> for <span class="math inline">\((\mathcal{F},\ast)\)</span>, and <span class="math inline">\((\mathcal{F},\ast)\)</span> must be <strong>cyclic</strong>.</li>
</ul>
<p>Let’s consider one simple <strong>cyclic group</strong>. For each positive integer <span class="math inline">\(k\)</span>, let <span class="math inline">\(\mathcal{U}_{k}=\{z\in\mathbb{C}|z^{k}=1\}\)</span>, then <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is a <strong>cyclic group</strong> of the <span class="math inline">\(k\)</span>-th roots of unity in <span class="math inline">\(\mathbb{C}\)</span>. The elements of <span class="math inline">\(\mathcal{U}_{k}\)</span> can be represented geometrically by equally spaced points on a (complex) unit circle around the origin. The <strong>generator</strong> of the <strong>cyclic group</strong> <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is <span class="math display">\[\cos\frac{2\pi}{k}+\mbox{i}\sin\frac{2\pi}{k}=\mbox{e}^{\mbox{i}2\pi/k},\]</span>
because <span class="math inline">\((\mbox{e}^{\mbox{i}2\pi/k})^{k}=1\)</span>.<label for="tufte-sn-595" class="margin-toggle sidenote-number">595</label><input type="checkbox" id="tufte-sn-595" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">595</span> Let <span class="math inline">\(\mbox{e}^{\mbox{i}2\pi/k}=\xi\)</span>. The <span class="math inline">\(k\)</span> roots can be written as <span class="math inline">\(1,\xi,\xi^{2},\dots,\xi^{n-1}\)</span>. These <span class="math inline">\(k\)</span> powers of <span class="math inline">\(\xi\)</span> are closed under the multiplication. For example, let <span class="math inline">\(k=6\)</span>, <span class="math display">\[\xi^{3}\xi^{7}=\xi^{10}=\xi^{6}\xi^{4}=1\times\xi^{4}=\xi^{4}.\]</span>
For any <span class="math inline">\(z\times z^{k-1}=z^{k}=1\)</span>, we can see that <span class="math inline">\(z\)</span> has the inverse <span class="math inline">\(z^{k-1}\in\mathbb{C}\)</span>.
Also, the multiplication <span class="math inline">\(\xi^{i}\xi^{j}\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to the addition <span class="math inline">\((i+j)\mbox{ mod }n\)</span>. So we can see that <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is isomorphic to <span class="math inline">\((\mathcal{Z}_{k},+)\)</span> where <span class="math inline">\(\mathcal{Z}_{k}=\{0,1,\dots,n-1\}\)</span> and <a href="ch-representation.html#sub:pseudoRandom">addition modulo</a> <span class="math inline">\(n\)</span> is closed on <span class="math inline">\(\mathcal{Z}_{k}\)</span>.</span></p>
<p>The discrete set <span class="math inline">\(\mathcal{U}_{k}=\{\mbox{e}^{\mbox{i}\frac{2\pi}{k}}=z\in\mathbb{C}|z^{k}=1\}\)</span> is a discretization of the <em>complex unit circle</em> <span class="math inline">\(\mathcal{U}= \{\mbox{e}^{\mbox{i}\theta}: \theta\in [0,2\pi )\}\)</span>. Note that <span class="math inline">\((\mathcal{U},\times)\)</span> is also a <strong>cyclic group</strong> whose cycle follows the period <span class="math inline">\(2\pi\)</span>.<label for="tufte-sn-596" class="margin-toggle sidenote-number">596</label><input type="checkbox" id="tufte-sn-596" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">596</span> The multiplication of complex numbers on the <strong>complex unit circle</strong> is associative. The identity element for the multiplication is <span class="math inline">\(1\)</span>. For any <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\in\mathcal{U}\)</span>, <span class="math display">\[\mbox{e}^{\mbox{i}\theta}\times\mbox{e}^{\mbox{i}(2\pi-\theta)}=\mbox{e}^{2\pi\mbox{i}}=1\]</span> means <span class="math inline">\(\mbox{e}^{\mbox{i}(2\pi-\theta)}\)</span> is the inverse of <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\)</span>.
Also, <span class="math inline">\((\mathcal{U},\times)\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to <span class="math inline">\((\mathbb{R}^{+},(+ \mod(2\pi))\)</span>, because <span class="math inline">\(z_{1}\times z_{2}\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to <span class="math inline">\((\theta_{1}+\theta_{2})\mbox{ mod }2\pi\)</span> where <span class="math inline">\(z_{j}=\mbox{e}^{\mbox{i}\theta_{j}}\)</span> for <span class="math inline">\(j=1,2\)</span>. In other words, the complex number multiplication on the unit circle and addition with modulo <span class="math inline">\(2\pi\)</span> on <span class="math inline">\(\mathbb{R}\)</span> have the same algebraic properties.</span></p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:denseCircle"></span>
<img src="fig/Part5/denseCircle.gif" alt="Equidistribution on the unit circle" width="100%"><!--
<p class="caption marginnote">-->Figure 18.4: Equidistribution on the unit circle<!--</p>-->
<!--</div>--></span>
</p>
<p>The relation between the groups <span class="math inline">\((\mathcal{U}_k, \times)\)</span> and <span class="math inline">\((\mathcal{U}, \times)\)</span> is disclosed as follows. Picking up some arbitrary point(s) on a unit circle, we can repeatedly rotate the point(s) by some chosen angle <span class="math inline">\(\alpha\)</span> so that the trajectory of the moving points can almost cover the whole unit circle. The angle <span class="math inline">\(\alpha\)</span> is chosen as follows. The location of the trajectory on the unit circle is contained in the set <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> so that the <a href="ch-randomization.html#sub:SumDecomp">closure</a> of the set is the <em>complex unit circle</em>, namely <span class="math display">\[\overline{\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}}=\{\mbox{e}^{\mbox{i}\alpha}: \alpha\in [0,2\pi )\}=\mathcal{U}.\]</span> The set <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> is called the <em>dense set</em> of <span class="math inline">\(\mathcal{U}\)</span>.<label for="tufte-sn-597" class="margin-toggle sidenote-number">597</label><input type="checkbox" id="tufte-sn-597" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">597</span> For example, the set of rational numbers <span class="math inline">\(\mathbb{Q}\)</span> is a <strong>dense set</strong> of <span class="math inline">\(\mathbb{R}\)</span>, namley <span class="math inline">\(\overline{\mathbb{Q}}=\mathbb{R}\)</span>.</span>
Figure <a href="ch-harmonicAn.html#fig:denseCircle">18.4</a> shows the construction of such a <a href="ch-randomization.html#sub:SumDecomp">closure</a>.</p>
<p>Note that <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> and <span class="math inline">\(\{\mbox{e}^{\mbox{i}n\alpha}\}_{n\in\mathbb{N}}\)</span> both are the <a href="ch-representation.html#sub:innerProd">Fourier bases</a>. In particular, if we choose <span class="math inline">\(\alpha\)</span> as <span class="math inline">\(\alpha=\frac{2\pi}{k}\)</span>, then we have another Fourier base <span class="math display">\[\left\{ \left.\left(\cos\left(n\frac{2\pi}{k}\right),\sin\left(n\frac{2\pi}{k}\right)\right)\right|n\in\mathbb{N}\right\}.\]</span> These three bases are all in <span class="math inline">\(\ell^2([0,2\pi])\)</span>, but their <a href="ch-randomization.html#sub:SumDecomp">closures</a> form the <a href="ch-MatComp.html#sub:vecSpaces">bases</a> in <span class="math inline">\(L^2([0,2\pi])\)</span>.</p>
<p>The above result is known as the <em>equidistribution theorem</em> that says for any continuous integrable function <span class="math inline">\(f:[0,2\pi]\rightarrow \mathbb{C}\)</span><label for="tufte-sn-598" class="margin-toggle sidenote-number">598</label><input type="checkbox" id="tufte-sn-598" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">598</span> 
In other words, the theorem says that if a sequence <span class="math inline">\(x_n\)</span> is the <strong>dense</strong> set of <span class="math inline">\([0,2\pi]\)</span>, then the sequence <span class="math inline">\(f(x_n)\)</span> is also <strong>dense</strong> on the image set of the function. When <span class="math inline">\(x_n=n\alpha \mbox{ mod } 2\pi\)</span> generates a <strong>dense set</strong> on <span class="math inline">\([0,2\pi]\)</span>, then <span class="math inline">\(f(x_n)=\mbox{e}^{\mbox{i}\alpha x_n}\)</span> or the wave terms <span class="math inline">\(\cos(n\alpha)\)</span> and <span class="math inline">\(\sin(n\alpha)\)</span> will also generate the <strong>dense set</strong> on the <strong>complex unit circle</strong>.</span>
<span class="math display">\[\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}f((n \alpha)\mbox{ mod }2\pi)=\int_{0}^{2\pi}f(\theta)\mbox{d}\theta.\]</span> This theorem serves as the cornerstone for the <a href="ch-representation.html#sub:pseudoRandom">pseudo-random number generators</a>, <a href="ch-CalUn.html#sub:divRV">monte Carol</a> integrals, as well as numerous arguments about the convergences of <a href="ch-CalUn.html#sub:rv">distribution functions</a> of (true) random variables.</p>
<div class="solution">
<p class="solution-begin">
Equidistribution <span id="sol-start-133" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-133', 'sol-start-133')"></span>
</p>
<div id="sol-body-133" class="solution-body" style="display: none;">
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From cyclic groups to character and convolution</span></p>
<p>It turns out that we can “project” the group objects onto the standard <strong>cyclic group</strong> <span class="math inline">\((\mathcal{U},\times)\)</span>. The “projection” is to extract the <strong>characters</strong> of the objects.</p>
<ul>
<li>
<strong>Character</strong> : A <em>character</em> <span class="math inline">\(\mathbf{F}\)</span> of a group <span class="math inline">\((\mathcal{G},\ast)\)</span> is a <a href="ch-complexAn.html#sub:coupling">homeomorphism</a> to the <strong>complex unit circle</strong> such that <span class="math inline">\(\mathbf{F}:(\mathcal{G},\ast)\rightarrow(\mathcal{U},\times)\)</span> and <span class="math display">\[\mathbf{F}(f\ast g)=\mathbf{F}(f)\times\mathbf{F}(g)\]</span>
for every <span class="math inline">\(f,g\in\mathcal{G}\)</span>.</li>
</ul>
<p>In other words, the <strong>character</strong> <span class="math inline">\(\mathbf{F}\)</span> makes two sets <span class="math inline">\(\mathcal{G}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> compatible with their group structures.
Let’s concentrate on a particular <strong>character</strong>, the <a href="ch-representation.html#sub:conjugacy">Fourier transform</a>, <span class="math display">\[\mathbf{F}_\theta(f)=\langle f, \mbox{e}^{\mbox{i}\theta} \rangle = \frac{1}{2\pi}\int_{-\infty}^{\infty} f(x) \mbox{e}^{-\mbox{i}\theta x}\mbox{d}x\]</span> for any bounded continuous function <span class="math inline">\(f\)</span>. This <strong>character</strong> connects the <a href="ch-harmonicAn.html#sub:heatEq">algebraic structures</a> of the <a href="ch-CalUn.html#sub:divRV">convolution</a> operation <span class="math inline">\((\star)\)</span> on the space of all bounded continuous functions <span class="math inline">\(\mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> and the multiplicative operation <span class="math inline">\((\times)\)</span> on the complex unit circle <span class="math inline">\(\mathcal{U}\)</span> such that
<span class="math display">\[\mathbf{F}_\theta(f \star g)=\mathbf{F}_\theta (f) \cdot \mathbf{F}_\theta(g)\]</span>
for <span class="math inline">\(f,g\in \mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>.<label for="tufte-sn-599" class="margin-toggle sidenote-number">599</label><input type="checkbox" id="tufte-sn-599" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">599</span> Note that although <span class="math inline">\(L^1(\mathbb{R})\)</span> is not a <a href="ch-MatComp.html#sub:vecSpaces">subspace</a> of <span class="math inline">\(L^2(\mathbb{R})\)</span>, <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">subspace</a> of <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>. The proof is given below.</span></p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-134" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-134', 'sol-start-134')"></span>
</p>
<div id="sol-body-134" class="solution-body" style="display: none;">
<p>For any <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>, <span class="math inline">\(f\)</span> is bounded, say <span class="math inline">\(|f(x)|\leq c\)</span> for any <span class="math inline">\(x\in\mathbb{R}\)</span>. Then <span class="math display">\[|f(x)|^{2}\leq c|f(x)|,\]</span>
which implies that
<span class="math display">\[\int|f(x)|^{2}\mbox{d}x\leq c\int|f(x)|\mbox{d}x=c\|f\|_{1}.\]</span>
Because <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>
and <span class="math inline">\(\|f\|_{1}\)</span> is finite, the former integral must be finite, namely <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>. That’s to say, any element in <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> must also be the element in <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>.</p>
<p>Thus, <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a subspace of <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The above result also is known as the <em>convolution theorem</em>. It states that the Fourier transform of a convolution is the pointwise product of Fourier transforms.<label for="tufte-sn-600" class="margin-toggle sidenote-number">600</label><input type="checkbox" id="tufte-sn-600" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">600</span> Technically speaking, the major use of this result is for the <a href="ch-representation.html#sub:conjugacy">completion</a> of the <span class="math inline">\(L^{1}\)</span> space. Consider any function <span class="math inline">\(f:\mathbb{R}\rightarrow\mathbb{C}\)</span> in the <span class="math inline">\(\mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>. The space <span class="math inline">\(\mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a pre-Hilbert space. By the <a href="ch-representation.html#sub:conjugacy">completion</a>, we can map <span class="math inline">\(f\)</span> to a completed <span class="math inline">\(L^{2}\)</span>-space (the <strong>complex unit circle</strong>) that is spanned by the orthonormal basis (Fourier basis). That is, for every <span class="math inline">\(f\in \mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>, we have <span class="math inline">\(\hat{f}=\mathbf{F}(f)\in \mathcal{C}(\mathbb{R})\cap L^2 (\mathbb{R})\)</span> and <span class="math inline">\(\|f\|=\|\hat{f}\|\)</span>. The map <span class="math inline">\(\mathbf{F}(\cdot):\mathcal{C}(\mathbb{R})\cap L^1 (\mathbb{R})\rightarrow \mathcal{C}(\mathbb{R})\cap L^2 (\mathbb{R})\)</span> is the Fourier transformation. In particular, when the map is <span class="math inline">\(\mathbf{F}(\cdot):\mathcal{C}(\mathbb{R})\cap L^2 (\mathbb{R})\rightarrow \mathcal{C}(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>,
the Fourier transformation is a <a href="ch-representation.html#sub:dualBasis">unitary</a> map.</span></p>
<p>To have a better understanding of this theorem, let’s consider a specific example. The <a href="ch-representation.html#sub:conjugacy">Fourier representations</a> for the continuous bounded functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are:<label for="tufte-sn-601" class="margin-toggle sidenote-number">601</label><input type="checkbox" id="tufte-sn-601" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">601</span> As they are in a subspace of <span class="math inline">\(L^2\)</span>, their Fourier representations exist.</span> <span class="math display">\[\begin{align*}f(x)&amp;=\sum_{m=-\infty}^{\infty}a_m\mbox{e}^{\mbox{i}mx}=\sum_{m=\infty}^{\infty}(\mathbf{F}_mF)\mbox{e}^{\mbox{i}mx}\\
  G(x)&amp;=\sum_{n=-\infty}^{\infty}b_n\mbox{e}^{\mbox{i}nx}=\sum_{n=-\infty}^{\infty}(\mathbf{F}_ng)\mbox{e}^{\mbox{i}nx}.\end{align*}\]</span>
Then the product of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> follows <span class="math display">\[f(x)g(x)=\sum_{d=-\infty}^{\infty}\mathbf{F}_m(f)\cdot\mathbf{F}_n(g)\mbox{e}^{-\mbox{i}dx}=\sum_{d=-\infty}^{\infty}\mathbf{F}_{d}(f\star g)\mbox{e}^{\mbox{i}dx}=\sum_{d=-\infty}^{\infty}c_d\mbox{e}^{\mbox{i}dx}.\]</span></p>
<p>More specifically, for two polynomials <span class="math display">\[\begin{align*}f(x)&amp;=a_{1}+\cdots+a_{m}x^{m-1}=\left[\begin{array}{c}
a_{1}\\
\vdots\\
a_{m}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{m-1}
\end{array}\right]=\mathbf{a}^{\top}\mathbf{p}(x)\\
g(x)&amp;=b_{1}+\cdots+b_{n}x^{n-1}=\left[\begin{array}{c}
b_{1}\\
\vdots\\
b_{n}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{n-1}
\end{array}\right]=\mathbf{b}^{\top}\mathbf{q}(x),\end{align*}\]</span> the multiplication of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> is<label for="tufte-sn-602" class="margin-toggle sidenote-number">602</label><input type="checkbox" id="tufte-sn-602" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">602</span> As you can see, the only important information regarding the multiplication of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> relies on the coefficient vector <span class="math inline">\(\mathbf{c}\)</span> that is, in fact, the <a href="ch-CalUn.html#sub:divRV">convolution</a> of the coefficient vectors <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span>.</span> <span class="math display">\[f(x)g(x)=h(x)=\left[\begin{array}{c}
c_{1}\\
\vdots\\
c_{n+m}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{n+m-1}
\end{array}\right]=\mathbf{c}^{\top}\mathbf{k}(x)\\
\mbox{where } c_{d}=\sum_{l}a_{l}b_{d-l+1}, \mbox{for }\:1\leq d\leq n+m.\]</span></p>
<p>For example, consider <span class="math inline">\(f(x)=1-x^{2}\)</span> and <span class="math inline">\(g(x)=x+2x^{2}\)</span>. The multiplication of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> is <span class="math inline">\(h(x)=x+2x^{2}-x^{3}-2x^{4}\)</span>. Now we turn to the coefficient vectors. For <span class="math inline">\(f(x)\)</span>
and <span class="math inline">\(g(x)\)</span>, <span class="math inline">\(\mathbf{a}=[1,0,-1]\)</span> and <span class="math inline">\(\mathbf{b}=[0,1,2]\)</span>. The convolution of <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span> is
<span class="math display">\[\mathbf{a}\star\mathbf{b}=\left[\begin{array}{c}
a_{1}b_{1}\\
a_{1}b_{2}+a_{2}b_{1}\\
a_{1}b_{3}+a_{2}b_{2}+a_{3}b_{1}\\
a_{2}b_{3}+a_{3}b_{2}\\
a_{3}b_{3}
\end{array}\right]=\left[\begin{array}{c}
0\\
1\\
2\\
-1\\
-2
\end{array}\right]\]</span> which is the coefficient vector of <span class="math inline">\(h(x)\)</span>.</p>
<p>Now we have displayed the full chain between the periodicity and Fourier series.
Intuitively, one can think of <a href="ch-representation.html#sub:conjugacy">Fourier transformation</a> as a <strong>characteristic</strong> “projection.” It “projects” some object onto a <strong>cyclic group</strong> in order to construct its continuous periodic counterpart.<label for="tufte-sn-603" class="margin-toggle sidenote-number">603</label><input type="checkbox" id="tufte-sn-603" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">603</span> For a function, the Fourier transformation is a projection from <span class="math inline">\(\mathbb{R}\)</span> to <span class="math inline">\(\mathbb{R}/\mathbb{Z}\)</span> to give a continuous periodic function on <span class="math inline">\(\mathbb{R}\)</span>.</span> For the new periodic object, one can represent it by the Fourier series that consists of the generators <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\)</span> from the group <span class="math inline">\((\mathcal{U},\times)\)</span> or the wave terms <span class="math inline">\(\cos(nk)\)</span> and <span class="math inline">\(\sin(nk)\)</span> from the group <span class="math inline">\((\mathcal{U}_k,\times)\)</span>. The <strong>character</strong> also reveals the relationship of the <a href="ch-harmonicAn.html#sub:heatEq">algebraic structure</a> under this “projection”: a convoluting object becomes a product of two separating objects.<label for="tufte-sn-604" class="margin-toggle sidenote-number">604</label><input type="checkbox" id="tufte-sn-604" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">604</span> In practice, aperiodic convolution can be expressed as a product of polynomials, and cyclic convolution is equivalent to a product of polynomials in a special <a href="ch-harmonicAn.html#sub:heatEq">group</a> called the polynomial ring.</span></p>
<p><span class="newthought">From convolution to mean value property</span></p>
<p><a href="ch-CalUn.html#sub:divRV">Convolution</a> is a special integral operation. <a href="ch-CalUn.html#sub:divRV">Convolutions</a> are often used to regularize functions. For example, if <span class="math inline">\(f\)</span> is integrable and <span class="math inline">\(g\)</span> is infinitely differentiable (smooth), then <span class="math inline">\(f\star g\)</span> is infinitely differentiable. Furthermore, if <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are integrable, then <span class="math inline">\(f\star g\)</span> is continuous.<label for="tufte-sn-605" class="margin-toggle sidenote-number">605</label><input type="checkbox" id="tufte-sn-605" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">605</span> We know that the <a href="ch-randomization.html#sub:RHilbert">delta function</a> is not differentiable in the general sense. But if we have a differentiable function <span class="math inline">\(f(x)\)</span>, its derivative at an arbitrary point <span class="math inline">\(a\)</span> can be defined as <span class="math display">\[\begin{align*}\left.\frac{\mbox{d}f(x)}{\mbox{d}x}\right|_{x=a} &amp;=F(a)\\
&amp;=\int\frac{\mbox{d}f(x)}{\mbox{d}x}\delta(a-x)\mbox{d}x \\ &amp;=\int f(x)\frac{\mbox{d}\delta(a-x)}{\mbox{d}x}\mbox{d}x \end{align*}\]</span>
where the last equality comes from the use of <a href="sub-calculus.html#sub:diffInt">the differentiation rule of products</a> such that <span class="math inline">\(\mathbf{D}f \star g = f\star \mathbf{D}g\)</span> for the differentiation operator <span class="math inline">\(\mathbf{D}\)</span>. Therefore, even though the differentiation of <span class="math inline">\(\delta(\cdot)\)</span> is not defined in general, one can represent this differentiation through the convolution <span class="math inline">\(F(a)=f\star(\frac{\mbox{d}\delta}{\mbox{d}x})\)</span>, where <span class="math inline">\(\delta\)</span> becomes “differentiable.”</span> In figure <a href="ch-representation.html#fig:Fourier">14.3</a>, we saw that the non-smoothness and discontinuity caused the irregular behaviors of the Fourier series. To eliminate the problems, one often need to convolute or integrate with a smooth and integrable function, called the integrated <em>kernel</em>. The <strong>kernel</strong> needs to be approximate to an identity under the integration so that, on average, it shouldn’t distort the underlying information. The construction of the <strong>kernel function</strong> relates to the <strong>mean value property</strong> of the <a href="ch-complexAn.html#sub:complexCal">analytic functions</a> / <a href="ch-harmonicAn.html#sub:heatEq">harmonic functions</a>.</p>
<p>Consider an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(z)+\mbox{i}v(z)\)</span>, where <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are <a href="ch-harmonicAn.html#sub:heatEq">harmonic functions</a>. For a path of the complex circle centering at <span class="math inline">\(z\)</span>, say <span class="math inline">\(\gamma(\beta)=z+r\mbox{e}^{\mbox{i}\beta}\)</span> with <span class="math inline">\(\gamma:[0,2\pi]\rightarrow\mathbb{C}\)</span>, the <a href="ch-eigen.html#sub:det">polar coordinate representation</a> <span class="math inline">\(z=r\mbox{e}^{\mbox{i}t}\)</span> of the <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> gives
<span class="math display">\[\begin{align*}
f(z)&amp;=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-z}\mbox{d}w =\frac{1}{2\pi\mbox{i}}\int_{0}^{2\pi}\frac{f(z+r\mbox{e}^{\mbox{i}\beta})}{r\mbox{e}^{\mbox{i}\beta}}r\mbox{i}\mbox{e}^{\mbox{i}\beta}\mbox{d}\beta\\
&amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(z+r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\end{align*}\]</span>
This representation simply says that the value of <span class="math inline">\(f(z)\)</span> is the same as the average value of the function going through a circle centering at <span class="math inline">\(z\)</span>. This is called the <em>mean value property</em> of the <a href="ch-complexAn.html#sub:complexCal">analytical function</a> <span class="math inline">\(f(\cdot)\)</span>. The <strong>mean value property</strong> of the <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> <span class="math inline">\(u\)</span> is
<span class="math display">\[u(z)=\frac{1}{2\pi}\int_{0}^{2\pi}u(z+r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\]</span></p>
<p>Let’s elaborate on this property. Note that the length of the radius <span class="math inline">\(r\)</span> can be arbitrarily chosen. Because the value of <span class="math inline">\(r\)</span> does not matter, we can simply set <span class="math inline">\(r=1\)</span>. So we will work on the <strong>complex unit circle</strong>. Now suppose we can “express” <span class="math inline">\(f(z+ r\mbox{e}^{\mbox{i}\beta})\)</span> as an integral of <span class="math inline">\(f(\cdot)\)</span> on the unit circle, namely <span class="math inline">\(f(\mbox{e}^{\mbox{i}\beta})\)</span>, with an <strong>integrated kernel</strong> function, i.e.,
<span class="math display">\[f(z)=\frac{1}{2\pi}\int^{2\pi}_{0} f(z+ r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta = \frac{1}{2\pi}\int^{2\pi}_{0} f(\mbox{e}^{\mbox{i}\beta}) K(\beta,z) \mbox{d}\beta\]</span> where <span class="math inline">\(K(\beta,z)\)</span> is the <strong>kernel function</strong>.<label for="tufte-sn-606" class="margin-toggle sidenote-number">606</label><input type="checkbox" id="tufte-sn-606" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">606</span> The intuitive motivation is as follows. Suppose we have a vector <span class="math inline">\(\mathbf{f}\)</span>, and we want <span class="math inline">\(\mathbf{f}\)</span> to be represented by another vector <span class="math inline">\(\mathbf{g}\)</span>. We would seek a matrix <span class="math inline">\(\mathbf{K}\)</span> such that <span class="math inline">\(\mathbf{f}=\mathbf{K}\mathbf{g}\)</span>. Now we imagine that the vectors are simply data generated by the function <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(y)\)</span>, then <span class="math inline">\(\mathbf{K}\)</span> is the matrix realization of the <strong>integrated kernel</strong> <span class="math inline">\(K(x,y)\)</span> such that <span class="math inline">\(f(x)=\int K(x,y)g(y)\mbox{d}y\)</span>.</span> Then we would arrive at a better representation using only the value of <span class="math inline">\(f(\cdot)\)</span> evaluated at the <strong>complex unit circle</strong>.</p>
<p>Such a <strong>kernel function</strong> <span class="math inline">\(K(\beta,z)\)</span> exists. It is called the <strong>Poisson kernel</strong>. We list different specific forms of the <em>Poisson kernel</em> below:
<span class="math display">\[\begin{align*}\mbox{Poisson kernel:} &amp; \, f(z)= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K(\beta,z)}{\underbrace{\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}+z}{\mbox{e}^{\mbox{i}\beta}-z}\right)}}\mbox{d}\beta,
 \\
\mbox{Polar form:} &amp; \, f(r\mbox{e}^{\mbox{i}\theta})=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K_{r}(\theta-\beta)}{\underbrace{\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}}}\mbox{d}\beta, \\
\mbox{Series form:} &amp; \, f(r\mbox{e}^{\mbox{i}\theta})= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K_{r}(\theta-\beta)}{\underbrace{\left(\sum_{n=-\infty}^{\infty}r^{|n|}\mbox{e}^{\mbox{i}n(\theta-\beta)}\right)}}\mbox{d}\beta. \end{align*}\]</span></p>
<div class="solution">
<p class="solution-begin">
Poisson kernel <span id="sol-start-135" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-135', 'sol-start-135')"></span>
</p>
<div id="sol-body-135" class="solution-body" style="display: none;">
<ol style="list-style-type: decimal">
<li>Poisson kernel.</li>
</ol>
<p>Assume that <span class="math inline">\(z\)</span> is inside the unit circle. We set the path of <span class="math inline">\(\gamma\)</span> on the unit circle such that <span class="math inline">\(|w|=1=\mbox{e}^{\mbox{i}\theta}\)</span>, the original <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> <span class="math display">\[f(z)=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-z}\mbox{d}w\]</span>
can be written as
<span class="math display">\[\begin{align*}
f(z)=\frac{1}{2\pi}\int_{0}^{2\pi}\frac{f(\mbox{e}^{\mbox{i}\beta})}{\mbox{e}^{\mbox{i}\beta}-z}\mbox{d}\beta=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right]\mbox{d}\beta.
\end{align*}\]</span></p>
<p>On the other hand, recall that the <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> is non-zero because of the <a href="ch-complexAn.html#sub:complexCal">singularity</a> caused by <span class="math inline">\(w-z=0\)</span>. Since <span class="math inline">\(z\)</span> is inside the unit circle, <span class="math inline">\(1/\bar{z}\)</span> must lie outside the unit circle. By replacing <span class="math inline">\(z\)</span> with <span class="math inline">\(1/\bar{z}\)</span> in the above formula, we will be able to remove the singularity and we can apply the <a href="ch-complexAn.html#sub:complexCal">fundamental theorem of the complex integral</a>,
<span class="math display">\[\begin{align*}
0=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-(\bar{z})^{-1}}\mbox{d}w=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}\right]\mbox{d}\beta.\end{align*}\]</span>
Rearrange the expression <span class="math display">\[\begin{align*}\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}&amp;=\frac{\bar{z}\mbox{e}^{\mbox{i}\beta}}{\bar{z}\mbox{e}^{\mbox{i}\beta}-1}=\frac{-\bar{z}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\\&amp;=1-\frac{\mbox{e}^{-\mbox{i}\beta}}{\mbox{e}^{-\mbox{i}\beta}-\bar{z}}=\overline{\left[1-\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\right]}.
\end{align*}\]</span></p>
<p>We combine the two cases of the integrals
<span class="math display">\[\begin{align*}f(z)-0  &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right]\mbox{d}t-\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}+\overline{\left(\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\right)}-1\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[2\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right)-1\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}+z}{\mbox{e}^{\mbox{i}\beta}-z}\right)\mbox{d}\beta.\end{align*}\]</span>
The result follows.</p>
<ol start="2" style="list-style-type: decimal">
<li>Polar form.</li>
</ol>
<p>We set <span class="math inline">\(z=r\mbox{e}^{\mbox{i}\theta}\)</span>. Then we have <span class="math display">\[\begin{align*}\frac{\mbox{e}^{\mbox{i}\beta}+r\mbox{e}^{\mbox{i}\theta}}{\mbox{e}^{\mbox{i}\beta}-r\mbox{e}^{\mbox{i}\theta}}&amp;=\frac{(\mbox{e}^{\mbox{i}\beta}+r\mbox{e}^{\mbox{i}\theta})(\mbox{e}^{-\mbox{i}\beta}-r\mbox{e}^{-\mbox{i}\theta})}{(\mbox{e}^{\mbox{i}\beta}-r\mbox{e}^{\mbox{i}\theta})(\mbox{e}^{-\mbox{i}\beta}-r\mbox{e}^{-\mbox{i}\theta})}\\&amp;=\frac{-r^{2}+1+2\mbox{i}r\sin(\theta-\beta)}{r^{2}-2r\cos(\theta-\beta)+1}\end{align*}\]</span>
where we applied the definition <span class="math inline">\(\sin x=\frac{\mbox{e}^{\mbox{i}x}-\mbox{e}^{\mbox{-i}x}}{2\mbox{i}}\)</span> and <span class="math inline">\(\cos x=\frac{\mbox{e}^{\mbox{i}x}+\mbox{e}^{-\mbox{i}x}}{2}\)</span>. The real part of the ratio is<span class="math display">\[\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}.\]</span>
So the full expression becomes <span class="math display">\[f(z)=f(r\mbox{e}^{\mbox{i}\theta})=\frac{1}{2\pi}\int_{0}^{2\pi}\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}f(\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Series form.</li>
</ol>
<p>The polar form gives<span class="math display">\[\frac{1}{2\pi}\int_{0}^{2\pi}\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}f(\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta \]</span>
Let <span class="math inline">\(w=r\mbox{e}^{\mbox{i}(\theta-\beta)}\)</span>, we have <span class="math display">\[\frac{1}{2}\frac{1+w}{1-w}=\frac{1}{1-w}-\frac{1}{2}=\sum_{n=0}^{\infty}w^{n}-\frac{1}{2},\]</span>
and <span class="math inline">\(w\bar{w}=r^{2}\)</span>, and <span class="math display">\[w+\bar{w}=2\mbox{Re}w=2r\cos(\beta-\theta).\]</span>
Then the kernel in the polar form can be written as
<span class="math display">\[\begin{align*}\frac{1-r^{2}}{1-2r\cos(\beta-\theta)+r^{2}}   &amp;=\frac{1-w\bar{w}}{1-(w+\bar{w})+w\bar{w}}\\
    &amp;=\frac{1}{2}\frac{(1+w)(1-\bar{w})+(1+\bar{w})(1-w)}{(1-w)(1-\bar{w})}\\
    &amp;=\frac{1}{2}\frac{1+w}{1-w}+\frac{1}{2}\frac{1+\bar{w}}{1-\bar{w}}=\sum_{n=0}^{\infty}w^{n}+\sum_{n=0}^{\infty}\bar{w}^{n}-1\\
    &amp;=\cdots+\bar{w}^{2}+\bar{w}+1+w+w^{2}+\cdots\\
    &amp;=\sum_{-\infty}^{\infty}r^{|n|}\mbox{e}^{\mbox{i}n(\beta-\theta)}\end{align*}\]</span>
The result follows.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From mean value property to Brownian motion</span></p>
<p>The last expression of the <strong>Poisson kernel</strong> connects to <a href="ch-representation.html#sub:innerProd">Fourier basis</a>. Note that for bounded continuous functions, we can interchange the integral and summation operations. The last expression becomes
<span class="math display">\[\begin{align*}f(r\mbox{e}^{\mbox{i}\theta})&amp;=\sum_{n=-\infty}^{\infty} \left( \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta}) \mbox{e}^{-\mbox{i}n\beta} \mbox{d}\beta \right) r^{|n|}\mbox{e}^{\mbox{i}n \theta}\\ &amp;= \sum_{n=-\infty}^{\infty}(\mathbf{F}_nf) r^{|n|}\mbox{e}^{\mbox{i}n \theta}
=\sum_{n=-\infty}^{\infty}c_nr^{|n|}\mbox{e}^{\mbox{i}n \theta},\end{align*}\]</span>
where <span class="math inline">\(\{c_n\}\)</span> are the Fourier coefficients of <span class="math inline">\(f(\cdot)\)</span> on the unit circle. Let <span class="math inline">\(r=1\)</span>, <span class="math inline">\(f(z)=\sum_{n=-\infty}^{\infty}c_n \mbox{e}^{\mbox{i}n \theta}\)</span> is the representation of the <a href="ch-representation.html#sub:innerProd">Fourier basis</a> generated by <span class="math inline">\(\mbox{e}^{\mbox{i} \theta}\)</span>. The Fourier series is infinitely differentiable and is harmonic, so does the <strong>Poisson kernel</strong> <span class="math inline">\(K(\cdot,\cdot)\)</span>.<label for="tufte-sn-607" class="margin-toggle sidenote-number">607</label><input type="checkbox" id="tufte-sn-607" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">607</span> The infinite differentiability is obvious as the representation has the exponential <span class="math inline">\(\mbox{e}^{\mbox{i}n\theta}\)</span>. Let’s consider the harmonicity. Given the radius <span class="math inline">\(r\)</span>, for any analytic function <span class="math inline">\(f\)</span>, the <strong>mean value property</strong> of the last expression says <span class="math display">\[\begin{align*}f(\theta) &amp;= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})K_{r}(\theta-\beta)\mbox{d}\beta\\ 
&amp;= f\star K_r (\theta).\end{align*}\]</span>
If <span class="math inline">\(f\)</span> is a harmonic function, say <span class="math inline">\(\Delta f =0\)</span>, we can write the convolution as <span class="math display">\[\Delta f = \Delta f \star K_r = f \star \Delta K_r = 0,\]</span>
which tells that the Poisson kernel <span class="math inline">\(K_r\)</span> is also harmonic <span class="math inline">\(\Delta K_r=0\)</span>.</span></p>
<p>So far, we have seen that a continuous second-order differentiable <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> can have the <strong>mean value property</strong> with respect to the <strong>Poisson kernel</strong>. In fact, the converse statement is also true.<label for="tufte-sn-608" class="margin-toggle sidenote-number">608</label><input type="checkbox" id="tufte-sn-608" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">608</span> Here is the intuition about the converse statement. For any continuous second-order differentiable function <span class="math inline">\(u\)</span>, the <strong>mean value property</strong> implies that <span class="math inline">\(u(\theta) = u \star K_r(\theta)\)</span> is a convolution of the infinitely differentiable <strong>Poisson kernel</strong> <span class="math inline">\(K\)</span>, so <span class="math inline">\(u(\theta)\)</span> must be infinitely differentiable. Thus, we can take the <a href="ch-harmonicAn.html#sub:heatEq">Laplacian</a> operator on <span class="math inline">\(u(\theta)\)</span>, which results in <span class="math display">\[\Delta u(\theta) = u\star \Delta K_r = 0,\]</span> because <span class="math inline">\(\Delta K_r=0\)</span>.</span> Together, we arrive at the conclusion that a continuous second-order differentiable function <span class="math inline">\(u\)</span> satisfies the <strong>mean value property</strong> (for the <strong>Poisson kernel</strong>) if and only if it is a <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a>.</p>
<p>There are various kernels. For different kernels, we would have different types of <strong>mean value properties</strong>. To close the tour, we will consider how does the <strong>mean value properties</strong> of the <strong>heat kernel</strong> work for the <a href="ch-randomization.html#sub:RHilbert">Brownian motion</a>.</p>
<p>A <span class="math inline">\(d\)</span>-dimensional <em>heat kernel</em> (or called <em>Gaussian kernel</em>) is a transition function <span class="math inline">\({K}_{d}(\cdot,\cdot):(0,\infty)\times\mathbb{R}^{d}\rightarrow(0,\infty)\)</span> such that
<span class="math display">\[{K}_{d}(t,\mathbf{x})=\frac{1}{(4\pi t)^{\frac{d}{2}}}\mbox{e}^{-\frac{\|\mathbf{x}\|^{2}}{4t}}.\]</span> The <strong>heat kernel</strong> is the solution of the <span class="math inline">\(d\)</span>-dimensional heat equation, namely <span class="math display">\[\frac{{K}_{d}(t,\mathbf{x})}{\partial t}=\Delta {K}_{d}(t,\mathbf{x})\]</span> where the <strong>Laplacian operator</strong> satisfies <span class="math inline">\(\Delta K_d(t,\mathbf{x})=\sum_{i=1}^{d} \frac{\partial^{2}K_d(t,\mathbf{x})}{\partial x_{i}^{2}}\)</span>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:2dBM"></span>
<img src="fig/Part5/2dBM.gif" alt="2D Brownian motion under the fixed heat distribution" width="100%"><!--
<p class="caption marginnote">-->Figure 18.5: 2D Brownian motion under the fixed heat distribution<!--</p>-->
<!--</div>--></span>
</p>
<div class="solution">
<p class="solution-begin">
Code <span id="sol-start-136" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-136', 'sol-start-136')"></span>
</p>
<div id="sol-body-136" class="solution-body" style="display: none;">
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Now consider a <a href="ch-randomization.html#sub:RHilbert">Brownian motion</a> whose <a href="ch-randomization.html#sub:RHilbert">increments</a> are the <a href="ch-randomization.html#sub:RHilbert">Gaussian white noises</a> such that <span class="math display">\[B(t,\omega) - B(s,\omega) \sim \mathcal{N}(0,2(t-s)).\]</span>
Let the initial state be <span class="math inline">\(y\)</span>, and the terminal state be <span class="math inline">\(x\)</span>. The <a href="ch-UnMulti.html#sub:Markov">transition probability</a>
<span class="math display">\[\begin{align*}
\mathbb{P}\left(\left.B(t,\omega)=x\right|B(0,\omega)=y\right)=
\frac{1}{\sqrt{4\pi t}}\mbox{e}^{-\frac{(x-y)^{2}}{4t}}= K_1(t,x-y) 
\end{align*}\]</span>
becomes the 1D <strong>heat kernel</strong>. For any continuous second differentiable function <span class="math inline">\(f\)</span>, the convolution of this function with the <strong>heat kernel</strong> is <span class="math display">\[\left(K_{1}(t,\cdot)\star u\right)(x)=\frac{1}{(4\pi t)^{\frac{1}{2}}}\int_{\mathbb{R}}\mbox{e}^{-\frac{\|x-y\|^{2}}{4t}}u(y)\mbox{d}y,\]</span> which is the same as the expectation of <span class="math inline">\(f(B(t,\omega)-B(0,\omega))\)</span> with <span class="math inline">\(B(t,\omega)-B(0,\omega)\sim \mathcal{N}(0,2t)\)</span>.</p>
<p>Let the expectation of the function <span class="math inline">\(f\)</span> at time <span class="math inline">\(t\)</span> be <span class="math inline">\(u(\cdot,t)\)</span>. The expected value function has a <strong>mean value property</strong> with respect to the <strong>heat kernel</strong> <span class="math inline">\(K_1(t,\cdot)\)</span>. Let <span class="math inline">\(u(y,0)=u_0(y)\)</span> be the initial of this function evaluated at the determined state <span class="math inline">\(y\)</span>. The <strong>mean value property</strong> with respect to the <strong>heat kernel</strong> says
<span class="math display">\[\begin{align*} 
u(x,t)&amp;=\mathbb{E}\left[\left.u\left(B(t,\omega),t\right)\right|u(B(0,\omega),0)=u_{0}(y)\right]\\
&amp;=\int u(y,0)K_{1}(t,x-y)\mbox{d}y.
\end{align*}\]</span>
Because the <strong>heat kernel</strong> is the solution of the <a href="ch-harmonicAn.html#sub:heatEq">heat equation</a>, so is this expected value function <span class="math inline">\(u(x,t)\)</span>. The proof is given below.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-137" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-137', 'sol-start-137')"></span>
</p>
<div id="sol-body-137" class="solution-body" style="display: none;">
<p>Since the transition probability serves the role as the transition <strong>kernel</strong>, we can introduce the shift operator <span class="math inline">\(\mathbf{L}^{-t}\)</span> such that <span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u_0 -u_0 }{t}=\lim_{t\rightarrow0}\frac{u(\cdot,t)-u(\cdot,0)}{t}=\frac{\partial u }{\partial t}\]</span></p>
<p>On the other hand, we can derive that <span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u-u}{t}= \frac{\partial^{2}u}{\partial x^{2}}.\]</span></p>
<p>Here is the derivation.</p>
<p>We know that
<span class="math display">\[\begin{align*}(\mathbf{L}^{-t}u_0)(x) &amp;=\int_{\mathbb{R}}p_{t}(x-y)u_0(y)\mbox{d}y \\
    &amp;=\int\frac{1}{\sqrt{4\pi t}}\mbox{e}^{-\frac{(x-y)^{2}}{4t}}u_0(y)\mbox{d}y \\
    &amp;=\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}u_0(x-\sqrt{2t}z)\mbox{d}z \end{align*}\]</span>
where the last equality comes from the change of variables <span class="math inline">\((x-y)/\sqrt{2t}=z\)</span> or <span class="math inline">\(x-z\sqrt{2t}=y\)</span>. Re-examinate the derivative
<span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u_0(x)-u_0(x)}{t}
    =\lim_{t\rightarrow0}\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{u_0(x-\sqrt{2t}z)-u_0(x)}{t}\mbox{d}z\]</span>
Note that we can expand <span class="math inline">\(u_{0}(x-\sqrt{2t}z)\)</span> at <span class="math inline">\(u_0(x)\)</span> by the <a href="sub-calculus.html#sub:Taylor">Taylor series</a> <span class="math display">\[u_{0}(x-\sqrt{2t}z)\approx u_{0}(x)-\frac{\partial u_{0}}{\partial x}\sqrt{2t}z+\frac{\partial^{2}u_{0}}{\partial x^{2}}(-\sqrt{2t}z)^{2}.\]</span>
Thus <span class="math display">\[u_0(x-\sqrt{2t}z)-u_0(x) \approx -\frac{\partial u_{0}}{\partial x}\sqrt{2t}z+\frac{\partial^{2}u_{0}}{\partial x^{2}}(-\sqrt{2t}z)^{2}.\]</span> Note that <span class="math inline">\(\int \frac{1}{\sqrt{2\pi}}e^{-\frac{z^{2}}{2}} z = 0\)</span> and <span class="math inline">\(\int \frac{1}{\sqrt{2\pi}}e^{-\frac{z^{2}}{2}} z^2 = 1\)</span> by the property of normal distribution density. Thus
<span class="math display">\[\begin{align*}\lim_{t\rightarrow0}\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{u_0(x-\sqrt{2t}z)-u_0(x)}{t}\mbox{d}z \\= \lim_{t\rightarrow0} \frac{\partial^{2}u_{0}}{\partial x^{2}} \int \frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{2z^{2}t}{2t}\mbox{d}z=\frac{\partial^{2}u_{0}}{\partial x^{2}}.\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
Probalistic interpretation of the Poisson kernel <span id="sol-start-138" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-138', 'sol-start-138')"></span>
</p>
<div id="sol-body-138" class="solution-body" style="display: none;">
<p>Let a particle move inside a unit circle following the law of Brownian motion. Define the time <span class="math inline">\(\tau\)</span> to be the first time that the particle hits the boundary of the circle <span class="math inline">\(\mathcal{U}\)</span>, namely <span class="math display">\[\tau(\omega) = \inf \{t : \mathbf{B}(t,\omega) \in \mathcal{U} \}\]</span>. If we want the particle to stop at the circle, we can use a harmonic function <span class="math inline">\(u\)</span> such that <span class="math inline">\(\Delta u(\mathbf{x}) =0\)</span> for <span class="math inline">\(\mathbf{x}\in \mathcal{U}\)</span>.<label for="tufte-sn-609" class="margin-toggle sidenote-number">609</label><input type="checkbox" id="tufte-sn-609" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">609</span> The reason is that Brownian motion can be described by the heat equation. So the equilibrium condition of the heat equation, namely <span class="math inline">\(\Delta u(\mathbf{x}) =0\)</span>, tells the Brownian motion to stop.</span> In this case, for every initial location <span class="math inline">\(\mathbf{y}\)</span> inside the unit circle, we have <span class="math display">\[\begin{align*}u(\mathbf{y})&amp;=\mathbb{E}\left[\left.u\left(\mathbf{B}(\tau,\omega)\right)\right|u(\mathbf{B}(0,\omega))=\mathbf{y} \right]\\
&amp;= \int u(\mathbf{x})\Pr\left(\left.\mbox{d}\mathbf{x} \in \mathbf{B}(\tau,\omega)\right|\mathbf{B}(0,\omega)=\mathbf{y}\right) \end{align*}\]</span> The probability <span class="math inline">\(\Pr\left(\mbox{d}\mathbf{x}\in\left.\mathbf{B}(\tau,\omega)\right|\mathbf{B}(0,\omega)=\mathbf{y}\right)\)</span> is called the hitting probability or exit distribution. The distribution is in fact the <strong>Poisson kernel</strong> and it is harmonic.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="ch-complexAn.html"><button class="btn btn-default">Previous</button></a>
<a href="bibliography.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-06-24
</p>
</div>
</div>



</body>
</html>
